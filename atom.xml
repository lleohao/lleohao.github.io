<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lleo</title>
  
  <subtitle>Lleohao`s blog</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://lleohao.github.io/"/>
  <updated>2020-11-24T06:07:16.912Z</updated>
  <id>https://lleohao.github.io/</id>
  
  <author>
    <name>Lleo hao</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Web é¡µé¢æ‰“å¼€ APP æ–¹å¼æ€»ç»“</title>
    <link href="https://lleohao.github.io/2020/11/12/Web%20%E9%A1%B5%E9%9D%A2%E8%B0%83%E7%94%A8%20APP%20%E6%96%B9%E5%BC%8F%E6%80%BB%E7%BB%93/"/>
    <id>https://lleohao.github.io/2020/11/12/Web é¡µé¢è°ƒç”¨ APP æ–¹å¼æ€»ç»“/</id>
    <published>2020-11-12T09:47:15.000Z</published>
    <updated>2020-11-24T06:07:16.912Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ğŸŒ-é€šç”¨æ–¹æ¡ˆ-URL-Scheme"><a href="#ğŸŒ-é€šç”¨æ–¹æ¡ˆ-URL-Scheme" class="headerlink" title="ğŸŒ é€šç”¨æ–¹æ¡ˆ URL Scheme"></a>ğŸŒ é€šç”¨æ–¹æ¡ˆ URL Scheme</h2><h3 id="å­¦æœ¯æ´¾ï¼Œäº†è§£ä»€ä¹ˆæ˜¯-URL-Scheme"><a href="#å­¦æœ¯æ´¾ï¼Œäº†è§£ä»€ä¹ˆæ˜¯-URL-Scheme" class="headerlink" title="å­¦æœ¯æ´¾ï¼Œäº†è§£ä»€ä¹ˆæ˜¯ URL Scheme"></a>å­¦æœ¯æ´¾ï¼Œäº†è§£ä»€ä¹ˆæ˜¯ URL Scheme</h3><p>URLï¼ˆUniform Resource Locatorï¼‰æ˜¯æŒ‡å®šåœ¨äº’è”ç½‘ä¸Šå¯ä»¥æ‰¾åˆ°èµ„æºçš„ä½ç½®çš„æ–‡æœ¬å­—ç¬¦ä¸²</p><p>é€šå¸¸å¯ä»¥åˆ†æˆä¸‰ä¸ªéƒ¨åˆ†ï¼šæ–¹æ¡ˆï¼ˆSchemeï¼‰ã€ä¸»æœºï¼ˆhostï¼‰ã€è·¯å¾„ï¼ˆpathï¼‰</p><p><img src="https://blogimages-10011410.cos.ap-shanghai.myqcloud.com/images/Web%20%E9%A1%B5%E9%9D%A2%E8%B0%83%E7%94%A8%20APP%20%E6%96%B9%E5%BC%8F%E6%80%BB%E7%BB%93/Untitled.png" alt="HTTP æƒå¨æŒ‡å— - URL"></p><p>å½“åº”ç”¨ç¨‹åºå¾—åˆ°ä¸€ä¸ª URL æ—¶ï¼Œé€šè¿‡å¯¹å®ƒçš„è§£æï¼Œå°±çŸ¥é“å»å“ªä¸ªåœ°æ–¹ã€ä»€ä¹ˆä½ç½®è·å–èµ„æºï¼ŒåŒæ—¶ç”¨å“ªç§æ–¹å¼å»å¤„ç†è¿™ä¸ªèµ„æº</p><p>ä¾‹å¦‚å½“æµè§ˆå™¨å¤„ç† <code>https://lleohao.github.io/archives/</code> è¿™ä¸ª URL æ—¶ï¼Œå®ƒå°±ä¼šä»¥ <code>http</code> åè®®çš„æ–¹å¼å»<code>lleohao.github.io</code> è¿™ä¸ªåŸŸåæ‰€å¯¹åº”çš„ä¸»æœºä¸‹æ‰¾å¯» <code>/archives/</code> ä½ç½®çš„æ–‡æ¡£</p><a id="more"></a><p>äº’è”ç½‘ä¸Šçš„èµ„æºä¸ä»…ä»…æŒ‡çš„æ˜¯ç½‘é¡µã€å›¾ç‰‡ã€è§†é¢‘ç­‰æ–‡ä»¶ï¼Œæˆ‘ä»¬çš„ App å’Œ App ä¸­çš„åŠŸèƒ½åŒæ ·ä¹Ÿå¯ä»¥è§†ä½œä¸€ä¸ªèµ„æº</p><p>å½“ APP åœ¨ç”¨æˆ·çš„è®¾å¤‡ä¸Šå®‰è£…æ—¶ï¼Œå…¶å¯ä»¥åœ¨ç³»ç»Ÿæ³¨å†ŒæŸä¸ªåè®®ï¼Œå¦‚çŸ¥ä¹æ‰€æ³¨å†Œçš„å°±æ˜¯ <code>zhihu</code></p><p>ç”¨æˆ·è®¿é—® <code>zhihu://articles/{id}</code> è¿™ä¸ª URL æ—¶å°±å¯ä»¥è®¿é—®åˆ°çŸ¥ä¹å¯¹åº”çš„æ–‡ç« é¡µé¢</p><h3 id="Web-é¡µé¢å¦‚ä½•è°ƒç”¨-URL-Scheme"><a href="#Web-é¡µé¢å¦‚ä½•è°ƒç”¨-URL-Scheme" class="headerlink" title="Web é¡µé¢å¦‚ä½•è°ƒç”¨ URL Scheme"></a>Web é¡µé¢å¦‚ä½•è°ƒç”¨ URL Scheme</h3><blockquote><p><a href="https://lleohao-blog-demo.netlify.app/pages/url-scheme" target="_blank" rel="noopener">URL Scheme æµ‹è¯•ç½‘é¡µ</a></p></blockquote><p><code>URL Scheme</code> å¯ä»¥è§†ä½œæ™®é€šçš„ URL é“¾æ¥ï¼Œ<strong>ç›´æ¥æŒ‰ç…§é“¾æ¥æ–¹å¼æ¥ä½¿ç”¨</strong></p><ol><li><p>ä½¿ç”¨ <code>a</code> æ ‡ç­¾</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"zhihu://articles/296580539"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>è®¾ç½® <code>location.href</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">openApp</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  location.href = <span class="string">"zhihu://articles/296580539"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨ <code>window.open</code> ä¼šæ€æ ·ï¼Ÿ</p><p>ğŸ›‘ ä¸è¦ä½¿ç”¨ <code>window.open</code> ï¼ŒIOS å¯ä»¥æ­£å¸¸çš„å¼€å¯ Appï¼ŒAndroid ä¸Šå¯èƒ½æ— æ³•å†·å¯åŠ¨ App ï¼ˆoppo æµè§ˆå™¨ï¼‰</p></li></ol><h3 id="URL-Scheme-çš„ç¼ºé™·"><a href="#URL-Scheme-çš„ç¼ºé™·" class="headerlink" title="URL Scheme çš„ç¼ºé™·"></a>URL Scheme çš„ç¼ºé™·</h3><ul><li><p>æ‰“å¼€ App å‰ä¼šæœ‰äºŒæ¬¡ç¡®å¼¹çª—ï¼Œä½“éªŒä¸å¤Ÿæµç•…</p><p><img src="https://blogimages-10011410.cos.ap-shanghai.myqcloud.com/images/Web%20%E9%A1%B5%E9%9D%A2%E8%B0%83%E7%94%A8%20APP%20%E6%96%B9%E5%BC%8F%E6%80%BB%E7%BB%93/Untitled%201.png" alt="IOS äºŒæ¬¡æç¤ºå¼¹çª—"></p></li><li><p>æ— æ³•åˆ¤æ–­æ‹‰ç«¯æ˜¯å¦æˆåŠŸ</p><ul><li><p>å·²å®‰è£…åº”ç”¨ï¼Œå¼¹å‡ºäºŒæ¬¡æç¤ºï¼Œä½†æ˜¯æ— æ³•è·å–ç”¨æˆ·æœ€ç»ˆç‚¹å‡»äº†æŒ‰é’®</p></li><li><p>æœªå®‰è£…åº”ç”¨</p><ul><li><p>IOS æç¤ºç½‘å€æ— æ•ˆ</p><p><img src="https://blogimages-10011410.cos.ap-shanghai.myqcloud.com/images/Web%20%E9%A1%B5%E9%9D%A2%E8%B0%83%E7%94%A8%20APP%20%E6%96%B9%E5%BC%8F%E6%80%BB%E7%BB%93/Untitled%202.png" alt="IOS æ˜¾ç¤ºç½‘å€æ— æ•ˆ"></p></li><li><p>Android é¡µé¢æ— ä»»ä½•ååº”</p></li></ul></li></ul></li><li><p>å­˜åœ¨å®‰å…¨é£é™©</p><p>ç”±äº URL Scheme çš„ä¸å”¯ä¸€æ€§ï¼Œå­˜åœ¨æ¶æ„çš„ App ä¼ªé€ å…¶å®ƒ App çš„ URL Schemeï¼Œå­˜åœ¨å®‰å…¨é£é™©</p></li></ul><p>æ€»ç»“æ¥è¯´ï¼Œç”±äºäºŒæ¬¡ç¡®è®¤å¼¹çª—çš„å­˜åœ¨ï¼Œé€ æˆäº†ä½“éªŒçš„åˆ†å‰²ï¼Œä¸å¤Ÿæµç•…</p><p>å…¶æ¬¡æ˜¯æ— æ³•è·å–å¼¹çª—çš„å“åº”çŠ¶æ€ï¼ˆç”¨æˆ·æ˜¯å¦ç¡®è®¤ã€å–æ¶ˆï¼‰åŠæœªå®‰è£… App çŠ¶æ€ï¼Œæ— æ³•é’ˆå¯¹ç”¨æˆ·çš„å“åº”ä½œå‡ºå¯¹åº”çš„å¤„ç†</p><h2 id="ğŸ‘-ä½“éªŒæ›´å¥½çš„æ–¹æ¡ˆ"><a href="#ğŸ‘-ä½“éªŒæ›´å¥½çš„æ–¹æ¡ˆ" class="headerlink" title="ğŸ‘ ä½“éªŒæ›´å¥½çš„æ–¹æ¡ˆ"></a>ğŸ‘ ä½“éªŒæ›´å¥½çš„æ–¹æ¡ˆ</h2><p>é’ˆå¯¹ URL Scheme å­˜åœ¨çš„é—®é¢˜ï¼ŒIOS ï¼ˆUniversal Linkï¼‰å’Œ Android ï¼ˆAndroid Applinkï¼‰éƒ½ç»™å‡ºäº†å¯¹åº”çš„è§£å†³æ–¹æ¡ˆ</p><p>ä¸ºæè¿°çš„æ–¹ä¾¿ï¼Œä¸‹æ–‡ä¸­çš„ <code>Universal Link</code> æŒ‡çš„æ˜¯ IOS ä¸‹çš„ <code>Universal Link</code> å’Œ Android ä¸‹çš„ <code>Android Applink</code></p><h3 id="å¦‚ä½•ç†è§£-Universal-Link"><a href="#å¦‚ä½•ç†è§£-Universal-Link" class="headerlink" title="å¦‚ä½•ç†è§£ Universal Link"></a>å¦‚ä½•ç†è§£ Universal Link</h3><p>ç®€å•æ¥è¯´ï¼Œå¯ä»¥å°† <code>Universal Link</code> ç†è§£æˆè¢« App æ³¨å†Œçš„ <code>https</code> é“¾æ¥</p><p>å½“ App å®‰è£…æ—¶ï¼Œç³»ç»Ÿä¼šå»æ³¨å†Œçš„ <code>https</code> é“¾æ¥çš„åŸŸåä¸‹æ£€æŸ¥æ˜¯å¦å­˜åœ¨ç›¸å…³çš„éªŒè¯çš„æ–‡ä»¶ï¼Œå¦‚æœå­˜åœ¨ï¼Œé‚£ä¹ˆä»¥åæµè§ˆå™¨åœ¨å¤„ç†è¯¥åŸŸåçš„ä¸‹çš„é“¾æ¥æ—¶å°±ä¼šè°ƒç”¨å¯¹åº”çš„ App çš„åšå¤„ç†</p><p><img src="https://blogimages-10011410.cos.ap-shanghai.myqcloud.com/images/Web%20%E9%A1%B5%E9%9D%A2%E8%B0%83%E7%94%A8%20APP%20%E6%96%B9%E5%BC%8F%E6%80%BB%E7%BB%93/mermaid-diagram-20201120102927.png" alt="Universal Link å·¥ä½œæµç¨‹"></p><h3 id="Universal-Link-ä¼˜ç‚¹"><a href="#Universal-Link-ä¼˜ç‚¹" class="headerlink" title="Universal Link ä¼˜ç‚¹"></a>Universal Link ä¼˜ç‚¹</h3><ul><li><strong>ä½“éªŒå¥½ï¼š</strong>æ²¡æœ‰äºŒæ¬¡çš„å¼¹çª—æç¤ºï¼Œå¯ä»¥æµç•…çš„å¼€å¯å®¢æˆ·ç«¯ï¼›åœ¨æ²¡æœ‰å®‰è£… App æ—¶ï¼Œä¹Ÿå¯ä»¥å‘æ­£å¸¸çš„é“¾æ¥ä¸€æ ·å·¥ä½œï¼Œä¸å½±å“ç”¨æˆ·çš„æµè§ˆ</li><li><strong>å®‰å…¨ï¼š</strong>éœ€è¦åœ¨ App ä¸Šé…ç½®åŸŸåï¼Œä¸”åœ¨å®‰è£…åç³»ç»ŸéªŒè¯ <code>Universal Link</code> éœ€è¦éªŒè¯å¯¹åº”åŸŸåä¸‹æ˜¯å¦å­˜åœ¨è¯´æ˜æ–‡ä»¶ï¼Œä¿è¯åªæœ‰è¯¥ App çš„ç®¡ç†å‘˜æ‰èƒ½åšæ­¤æ“ä½œ</li><li><strong>çªç ´å°é”ï¼š</strong>IOS ä¸‹ *<strong>*<code>Universal Link</code> å¯ä»¥çªç ´å¾®ä¿¡é™åˆ¶åœ¨å…¶ <code>Webview</code> ä¸­æ‹‰ç«¯çš„é™åˆ¶ï¼›</strong>Android æœªæµ‹è¯•**</li></ul><h2 id="ğŸ’¯-å®è·µæ¡ˆä¾‹"><a href="#ğŸ’¯-å®è·µæ¡ˆä¾‹" class="headerlink" title="ğŸ’¯ å®è·µæ¡ˆä¾‹"></a>ğŸ’¯ å®è·µæ¡ˆä¾‹</h2><blockquote><p>ä»¥çŸ¥ä¹çš„é¦–é¡µçš„ â€œæ‰“å¼€ APPâ€ çš„åŠŸèƒ½è¿›è¡Œåˆ†æ</p></blockquote><h3 id="IOS"><a href="#IOS" class="headerlink" title="IOS"></a>IOS</h3><p>ç”±äº IOS ä¸Šå¯¹äºçš„ <code>Universal Link</code> çš„å¤„ç†<strong>éœ€è¦åœ¨è·¨åŸŸæ—¶æ‰èƒ½ç”Ÿæ•ˆ</strong>ï¼ˆæœªè·¨åŸŸæ—¶æŒ‰ç…§æ­£å¸¸çš„é“¾æ¥å¤„ç†ï¼‰ï¼Œæ‰€ä»¥çŸ¥ä¹ä»¥ <code>[https://oia.zhihu.com](https://oia.zhihu.com)</code> ä½œä¸ºæ‰“å¼€ App çš„ç›®æ ‡é“¾æ¥</p><p><img src="https://blogimages-10011410.cos.ap-shanghai.myqcloud.com/images/Web%20%E9%A1%B5%E9%9D%A2%E8%B0%83%E7%94%A8%20APP%20%E6%96%B9%E5%BC%8F%E6%80%BB%E7%BB%93/mermaid-diagram-20201122202042.png" alt="IOS çŸ¥ä¹æ‹‰ç«¯æµç¨‹"></p><h3 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h3><p>Android ä¸Šæ²¡æœ‰è·¨åŸŸçš„é™åˆ¶ï¼Œå¯ä»¥è®¿é—®ä¸»åŸŸåä¸‹çš„åœ°å€</p><p><img src="https://blogimages-10011410.cos.ap-shanghai.myqcloud.com/images/Web%20%E9%A1%B5%E9%9D%A2%E8%B0%83%E7%94%A8%20APP%20%E6%96%B9%E5%BC%8F%E6%80%BB%E7%BB%93/mermaid-diagram-20201122202042.png" alt="Android çŸ¥ä¹æ‹‰ç«¯æµç¨‹"></p><h2 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h2><p><a href="https://developer.apple.com/ios/universal-links/" target="_blank" rel="noopener">Universal Links - Apple Developer</a></p><p><a href="https://developer.android.com/training/app-links" target="_blank" rel="noopener">Android Applinks</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ğŸŒ-é€šç”¨æ–¹æ¡ˆ-URL-Scheme&quot;&gt;&lt;a href=&quot;#ğŸŒ-é€šç”¨æ–¹æ¡ˆ-URL-Scheme&quot; class=&quot;headerlink&quot; title=&quot;ğŸŒ é€šç”¨æ–¹æ¡ˆ URL Scheme&quot;&gt;&lt;/a&gt;ğŸŒ é€šç”¨æ–¹æ¡ˆ URL Scheme&lt;/h2&gt;&lt;h3 id=&quot;å­¦æœ¯æ´¾ï¼Œäº†è§£ä»€ä¹ˆæ˜¯-URL-Scheme&quot;&gt;&lt;a href=&quot;#å­¦æœ¯æ´¾ï¼Œäº†è§£ä»€ä¹ˆæ˜¯-URL-Scheme&quot; class=&quot;headerlink&quot; title=&quot;å­¦æœ¯æ´¾ï¼Œäº†è§£ä»€ä¹ˆæ˜¯ URL Scheme&quot;&gt;&lt;/a&gt;å­¦æœ¯æ´¾ï¼Œäº†è§£ä»€ä¹ˆæ˜¯ URL Scheme&lt;/h3&gt;&lt;p&gt;URLï¼ˆUniform Resource Locatorï¼‰æ˜¯æŒ‡å®šåœ¨äº’è”ç½‘ä¸Šå¯ä»¥æ‰¾åˆ°èµ„æºçš„ä½ç½®çš„æ–‡æœ¬å­—ç¬¦ä¸²&lt;/p&gt;&lt;p&gt;é€šå¸¸å¯ä»¥åˆ†æˆä¸‰ä¸ªéƒ¨åˆ†ï¼šæ–¹æ¡ˆï¼ˆSchemeï¼‰ã€ä¸»æœºï¼ˆhostï¼‰ã€è·¯å¾„ï¼ˆpathï¼‰&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://blogimages-10011410.cos.ap-shanghai.myqcloud.com/images/Web%20%E9%A1%B5%E9%9D%A2%E8%B0%83%E7%94%A8%20APP%20%E6%96%B9%E5%BC%8F%E6%80%BB%E7%BB%93/Untitled.png&quot; alt=&quot;HTTP æƒå¨æŒ‡å— - URL&quot;&gt;&lt;/p&gt;&lt;p&gt;å½“åº”ç”¨ç¨‹åºå¾—åˆ°ä¸€ä¸ª URL æ—¶ï¼Œé€šè¿‡å¯¹å®ƒçš„è§£æï¼Œå°±çŸ¥é“å»å“ªä¸ªåœ°æ–¹ã€ä»€ä¹ˆä½ç½®è·å–èµ„æºï¼ŒåŒæ—¶ç”¨å“ªç§æ–¹å¼å»å¤„ç†è¿™ä¸ªèµ„æº&lt;/p&gt;&lt;p&gt;ä¾‹å¦‚å½“æµè§ˆå™¨å¤„ç† &lt;code&gt;https://lleohao.github.io/archives/&lt;/code&gt; è¿™ä¸ª URL æ—¶ï¼Œå®ƒå°±ä¼šä»¥ &lt;code&gt;http&lt;/code&gt; åè®®çš„æ–¹å¼å»&lt;code&gt;lleohao.github.io&lt;/code&gt; è¿™ä¸ªåŸŸåæ‰€å¯¹åº”çš„ä¸»æœºä¸‹æ‰¾å¯» &lt;code&gt;/archives/&lt;/code&gt; ä½ç½®çš„æ–‡æ¡£&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="Web" scheme="https://lleohao.github.io/tags/Web/"/>
    
      <category term="H5" scheme="https://lleohao.github.io/tags/H5/"/>
    
      <category term="Android" scheme="https://lleohao.github.io/tags/Android/"/>
    
      <category term="IOS" scheme="https://lleohao.github.io/tags/IOS/"/>
    
      <category term="iPhone" scheme="https://lleohao.github.io/tags/iPhone/"/>
    
      <category term="App" scheme="https://lleohao.github.io/tags/App/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ travis å‘å¸ƒ npm åŒ…</title>
    <link href="https://lleohao.github.io/2020/06/29/%E4%BD%BF%E7%94%A8-travis-%E5%8F%91%E5%B8%83-npm-%E5%8C%85/"/>
    <id>https://lleohao.github.io/2020/06/29/ä½¿ç”¨-travis-å‘å¸ƒ-npm-åŒ…/</id>
    <published>2020-06-29T07:11:20.000Z</published>
    <updated>2020-11-24T06:07:16.916Z</updated>
    
    <content type="html"><![CDATA[<h3 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL:DR"></a>TL:DR</h3><blockquote><p>ç›¸å…³é“¾æ¥</p><ul><li><a href="https://github.com/travis-ci/travis.rb#readme" target="_blank" rel="noopener">travis-cli æ–‡æ¡£</a></li><li><a href="https://docs.travis-ci.com/user/deployment/npm/" target="_blank" rel="noopener">Travis NPM Releasing æ–‡æ¡£</a></li></ul></blockquote><ol><li><p>è·å–éœ€è¦çš„ <code>Token</code></p><ul><li><a href="https://github.com/settings/tokens" target="_blank" rel="noopener">Github Access Token</a></li><li><a href="https://docs.travis-ci.com/user/deployment/npm/#npm-auth-token" target="_blank" rel="noopener">NPM auth token è·å–æ–¹å¼</a> åœ¨ <code>travis</code> ä¸­ä¹Ÿç§°åš <code>api_key</code></li></ul></li><li><p>ç™»å½• <code>Travis cli</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">travis login --com --github-token &lt;GITHUB_ACCESS_TOKEN&gt;</span><br></pre></td></tr></table></figure></li><li><p>é…ç½®åŸºç¡€ <code>.travis.yml</code>ï¼Œä½¿ç”¨ <code>travis setup npm</code> çš„å‰ç½®ä¾èµ–</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">language:</span> <span class="string">node_js</span></span><br><span class="line"><span class="attr">node_js:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="number">14</span></span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨ <code>travis setup npm</code> å‘½ä»¤è¡¥å……é…ç½®</p></li></ol><a id="more"></a><h3 id="å¦‚ä½•ä¿æŠ¤è‡ªå·±çš„ç§å¯†ä¿¡æ¯"><a href="#å¦‚ä½•ä¿æŠ¤è‡ªå·±çš„ç§å¯†ä¿¡æ¯" class="headerlink" title="å¦‚ä½•ä¿æŠ¤è‡ªå·±çš„ç§å¯†ä¿¡æ¯"></a>å¦‚ä½•ä¿æŠ¤è‡ªå·±çš„ç§å¯†ä¿¡æ¯</h3><p>æ‰§è¡Œ <code>npm publish</code> æ—¶éœ€è¦ <code>npm</code> çš„ <code>auth token</code> ï¼Œè€Œè¿™ä¸ªä¿¡æ¯æ˜¾ç„¶æ˜¯ä¸é€‚åˆä¸­æ˜¾å¼çš„æ”¾åœ¨ <code>.travis.yml</code> ä¸­</p><p>è¿™æ—¶å¯ä»¥é€šè¿‡ <code>travis encrypt</code> å‘½ä»¤æ¥åŠ å¯†ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">travis encrypt &lt;TOKEN&gt; --add &lt;CONFIG.PATH&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># YOUR_AUTH_TOKEN éœ€è¦åŠ å¯†çš„TOKEN</span></span><br><span class="line"><span class="comment"># CONFIG.PATH åœ¨ yml æ–‡ä»¶ï¼ˆå¯ç†è§£ä¸ºå¯¹è±¡ï¼‰ä¸­çš„ä½ç½®ï¼Œå¦‚ `deploy.api_key` ä»£è¡¨æ˜¯ `deploy` ä¸‹çš„ `api_key` å±æ€§</span></span><br></pre></td></tr></table></figure><p><strong>è¿™åŒæ ·ä¹Ÿé€‚åˆå…¶å®ƒéœ€è¦åŠ å¯†çš„ä¿¡æ¯ï¼Œå¦‚ä½ çš„æ•°æ®åº“é“¾æ¥ä¿¡æ¯</strong></p><h3 id="æŒ‡å®šå‘å¸ƒçš„æ—¶æœº"><a href="#æŒ‡å®šå‘å¸ƒçš„æ—¶æœº" class="headerlink" title="æŒ‡å®šå‘å¸ƒçš„æ—¶æœº"></a>æŒ‡å®šå‘å¸ƒçš„æ—¶æœº</h3><ol><li><p>æŒ‡å®šåˆ†æ”¯å‘å¸ƒ</p><p><strong>ç‰¹å®šåˆ†æ”¯</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line"><span class="attr">branch:</span> <span class="string">production</span></span><br></pre></td></tr></table></figure><p><strong>æ‰€æœ‰åˆ†æ”¯</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line"><span class="attr">all_branch:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></li><li><p>å­˜åœ¨æ–°çš„ <code>tag</code> æ—¶å‘å¸ƒ</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line"><span class="attr">tags:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p><strong>è®°å¾—ä½¿ç”¨ <code>git push --tags</code> æ¨é€ <code>tag</code> åˆ° <code>github</code> ä¸Š</strong></p></li></ol><h3 id="ç–‘éš¾é—®é¢˜è§£ç­”"><a href="#ç–‘éš¾é—®é¢˜è§£ç­”" class="headerlink" title="ç–‘éš¾é—®é¢˜è§£ç­”"></a>ç–‘éš¾é—®é¢˜è§£ç­”</h3><ol><li><p><code>travis login</code> ç¢°åˆ° <code>has not granted Travis CI the required permissions, please log in via travis-ci.org</code> æ€ä¹ˆå¤„ç†ï¼Ÿ</p><p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ <code>travis-ci.org</code> çš„è¯ï¼Œä¼šç¢°åˆ°è¿™ä¸ªé—®é¢˜ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯è¿ç§»åˆ° <code>travis-org.com</code>ã€‚åŒæ—¶ä½¿ç”¨ <code>travis login --com</code> å‘½ä»¤ç™»å½•</p><p>è¡¥å……ä¸€ä¸ªç›¸å…³é—®é¢˜çš„é“¾æ¥ <a href="https://github.com/dwyl/learn-travis/issues/60#issuecomment-620692873" target="_blank" rel="noopener">travis-ci.org vs travis-ci.com?</a></p></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;TL-DR&quot;&gt;&lt;a href=&quot;#TL-DR&quot; class=&quot;headerlink&quot; title=&quot;TL:DR&quot;&gt;&lt;/a&gt;TL:DR&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;ç›¸å…³é“¾æ¥&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/travis-ci/travis.rb#readme&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;travis-cli æ–‡æ¡£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.travis-ci.com/user/deployment/npm/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Travis NPM Releasing æ–‡æ¡£&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;è·å–éœ€è¦çš„ &lt;code&gt;Token&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/settings/tokens&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Github Access Token&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.travis-ci.com/user/deployment/npm/#npm-auth-token&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;NPM auth token è·å–æ–¹å¼&lt;/a&gt; åœ¨ &lt;code&gt;travis&lt;/code&gt; ä¸­ä¹Ÿç§°åš &lt;code&gt;api_key&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç™»å½• &lt;code&gt;Travis cli&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;travis login --com --github-token &amp;lt;GITHUB_ACCESS_TOKEN&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;é…ç½®åŸºç¡€ &lt;code&gt;.travis.yml&lt;/code&gt;ï¼Œä½¿ç”¨ &lt;code&gt;travis setup npm&lt;/code&gt; çš„å‰ç½®ä¾èµ–&lt;/p&gt;
&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;language:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;node_js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;node_js:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;bullet&quot;&gt;  -&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä½¿ç”¨ &lt;code&gt;travis setup npm&lt;/code&gt; å‘½ä»¤è¡¥å……é…ç½®&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
    
    
      <category term="travis" scheme="https://lleohao.github.io/tags/travis/"/>
    
      <category term="npm" scheme="https://lleohao.github.io/tags/npm/"/>
    
      <category term="ci" scheme="https://lleohao.github.io/tags/ci/"/>
    
      <category term="github" scheme="https://lleohao.github.io/tags/github/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ pointer-events è§£å†³ svg å…ƒç´ è·¯å¾„å†…ä¸è§¦å‘é¼ æ ‡äº‹ä»¶</title>
    <link href="https://lleohao.github.io/2019/10/12/%E4%BD%BF%E7%94%A8-pointer-events-%E8%A7%A3%E5%86%B3-svg-%E5%85%83%E7%B4%A0%E8%B7%AF%E5%BE%84%E5%86%85%E4%B8%8D%E8%A7%A6%E5%8F%91%E9%BC%A0%E6%A0%87%E4%BA%8B%E4%BB%B6/"/>
    <id>https://lleohao.github.io/2019/10/12/ä½¿ç”¨-pointer-events-è§£å†³-svg-å…ƒç´ è·¯å¾„å†…ä¸è§¦å‘é¼ æ ‡äº‹ä»¶/</id>
    <published>2019-10-12T03:25:13.000Z</published>
    <updated>2020-11-24T06:07:16.916Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é—®é¢˜èƒŒæ™¯"><a href="#é—®é¢˜èƒŒæ™¯" class="headerlink" title="é—®é¢˜èƒŒæ™¯"></a>é—®é¢˜èƒŒæ™¯</h2><iframe src="https://codesandbox.io/embed/point-events-shuxingxiangjie-2f8tb?fontsize=14" title="point-events å±æ€§è¯¦è§£" allow="geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb" style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"></iframe>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;é—®é¢˜èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#é—®é¢˜èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜èƒŒæ™¯&quot;&gt;&lt;/a&gt;é—®é¢˜èƒŒæ™¯&lt;/h2&gt;&lt;iframe src=&quot;https://codesandbox.io/embed/point-events-shuxingxia
      
    
    </summary>
    
    
      <category term="è¸©å‘æŒ‡åŒ—" scheme="https://lleohao.github.io/categories/%E8%B8%A9%E5%9D%91%E6%8C%87%E5%8C%97/"/>
    
    
      <category term="css" scheme="https://lleohao.github.io/tags/css/"/>
    
      <category term="svg" scheme="https://lleohao.github.io/tags/svg/"/>
    
      <category term="å‰ç«¯" scheme="https://lleohao.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•åœ¨ vscode ä¸­å…±äº«å›¢é˜Ÿé—´çš„é¡¹ç›®é…ç½®å’Œæ’ä»¶é…ç½®</title>
    <link href="https://lleohao.github.io/2019/09/23/%E5%A6%82%E4%BD%95%E5%9C%A8-vscode-%E4%B8%AD%E5%85%B1%E4%BA%AB%E5%9B%A2%E9%98%9F%E9%97%B4%E7%9A%84%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AE%E5%92%8C%E6%8F%92%E4%BB%B6%E9%85%8D%E7%BD%AE/"/>
    <id>https://lleohao.github.io/2019/09/23/å¦‚ä½•åœ¨-vscode-ä¸­å…±äº«å›¢é˜Ÿé—´çš„é¡¹ç›®é…ç½®å’Œæ’ä»¶é…ç½®/</id>
    <published>2019-09-23T11:37:14.000Z</published>
    <updated>2020-11-24T06:07:16.916Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æœ€è¿‘å›¢é˜Ÿä¸­å¼€å¯äº†è®¸å¤šæ–°çš„å‰ç«¯é¡¹ç›®ï¼Œä¹Ÿæœ‰æ–°çš„åŒäº‹åŠ å…¥äº†å›¢é˜Ÿä¸­</p><p>é¡¹ç›®å¤šäº†ï¼Œå¦‚ä½•ç¡®ä¿æ‰€æœ‰æˆå‘˜éƒ½æœ‰ä¸€è‡´çš„å¼€å‘ç¯å¢ƒå°±æ˜¯ä¸€ä¸ªéº»çƒ¦çš„é—®é¢˜ï¼Œæœ¬æ–‡å°†ä»‹ç»å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜</p></blockquote><h2 id="èƒŒæ™¯çŸ¥è¯†"><a href="#èƒŒæ™¯çŸ¥è¯†" class="headerlink" title="èƒŒæ™¯çŸ¥è¯†"></a>èƒŒæ™¯çŸ¥è¯†</h2><p><code>vscode</code> ä¸­çš„é…ç½®ä¿¡æ¯åˆ†ä¸º<strong>ç”¨æˆ·é…ç½®</strong>å’Œ<strong>é¡¹ç›®é…ç½®</strong>ä¸¤ç§</p><ul><li>ç”¨æˆ·é…ç½®åœ¨æ‰€æœ‰æ‰“å¼€çš„ <code>vscode</code> ä¸­ç”Ÿæ•ˆ</li><li>é¡¹ç›®é…ç½®å­˜æ”¾äºé¡¹ç›®æ‰€åœ¨ä½ç½®çš„ <code>.vscode</code> æ–‡ä»¶å¤¹ä¸­ï¼Œå½“é¡¹ç›®åœ¨ <code>vscode</code> ä¸­æ‰“å¼€æ—¶ï¼Œé’ˆå¯¹æ‰“å¼€çš„çª—å£ç”Ÿæ•ˆ</li></ul><p>å¦‚æœåŒæ—¶å­˜åœ¨é¡¹ç›®é…ç½®å’Œç”¨æˆ·é…ç½®ï¼Œå°†ä»¥é¡¹ç›®é…ç½®ä¼˜å…ˆ</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡é¡¹ç›®é…ç½®æ–‡ä»¶æ¥å…±äº« <code>vscode</code> é…ç½®ï¼Œè¾¾åˆ°ç»Ÿä¸€å¼€å‘ç¯å¢ƒçš„ç›®çš„</p><h2 id="åŒæ­¥æ’ä»¶"><a href="#åŒæ­¥æ’ä»¶" class="headerlink" title="åŒæ­¥æ’ä»¶"></a>åŒæ­¥æ’ä»¶</h2><p>æ’ä»¶æ–‡ä»¶ <code>extensions.json</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// ç¤ºä¾‹ä»£ç </span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"recommendations"</span>: [</span><br><span class="line">    <span class="string">"dbaeumer.vscode-eslint"</span>,</span><br><span class="line">    <span class="string">"esbenp.prettier-vscode"</span>,</span><br><span class="line">    <span class="string">"octref.vetur"</span>,</span><br><span class="line">    <span class="string">"formulahendry.auto-close-tag"</span>,</span><br><span class="line">    <span class="string">"formulahendry.auto-rename-tag"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a><p>æ’ä»¶åç§°</p><p><img src="img-1.png" alt="ä»¥ &lt;æ’ä»¶å¼€å‘è€…&gt;.&lt;æ’ä»¶åç§°&gt; æ¥ç¡®å®šå…·ä½“çš„æ’ä»¶"></p><p>è®¾ç½®å®Œæˆåï¼Œå¯ä»¥åœ¨ <code>vscode</code> æ’ä»¶é…ç½®ä¸­ä¸€é”®å®‰è£…ä¸Šé¢è®¾ç½®çš„æ’ä»¶</p><p><img src="img-2.png" alt="@recommended æœç´¢æ¨èçš„æ’ä»¶"></p><h2 id="åŒæ­¥é…ç½®"><a href="#åŒæ­¥é…ç½®" class="headerlink" title="åŒæ­¥é…ç½®"></a>åŒæ­¥é…ç½®</h2><p>é…ç½®æ–‡ä»¶ <code>settings.json</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"eslint.autoFixOnSave"</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é…ç½®æ–‡ä»¶çš„æ˜¯è‡ªåŠ¨ç”Ÿæ•ˆçš„</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æœ€è¿‘å›¢é˜Ÿä¸­å¼€å¯äº†è®¸å¤šæ–°çš„å‰ç«¯é¡¹ç›®ï¼Œä¹Ÿæœ‰æ–°çš„åŒäº‹åŠ å…¥äº†å›¢é˜Ÿä¸­&lt;/p&gt;
&lt;p&gt;é¡¹ç›®å¤šäº†ï¼Œå¦‚ä½•ç¡®ä¿æ‰€æœ‰æˆå‘˜éƒ½æœ‰ä¸€è‡´çš„å¼€å‘ç¯å¢ƒå°±æ˜¯ä¸€ä¸ªéº»çƒ¦çš„é—®é¢˜ï¼Œæœ¬æ–‡å°†ä»‹ç»å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜&lt;/p&gt;
&lt;/blockquote&gt;&lt;h2 id=&quot;èƒŒæ™¯çŸ¥è¯†&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯çŸ¥è¯†&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯çŸ¥è¯†&quot;&gt;&lt;/a&gt;èƒŒæ™¯çŸ¥è¯†&lt;/h2&gt;&lt;p&gt;&lt;code&gt;vscode&lt;/code&gt; ä¸­çš„é…ç½®ä¿¡æ¯åˆ†ä¸º&lt;strong&gt;ç”¨æˆ·é…ç½®&lt;/strong&gt;å’Œ&lt;strong&gt;é¡¹ç›®é…ç½®&lt;/strong&gt;ä¸¤ç§&lt;/p&gt;&lt;ul&gt;
&lt;li&gt;ç”¨æˆ·é…ç½®åœ¨æ‰€æœ‰æ‰“å¼€çš„ &lt;code&gt;vscode&lt;/code&gt; ä¸­ç”Ÿæ•ˆ&lt;/li&gt;
&lt;li&gt;é¡¹ç›®é…ç½®å­˜æ”¾äºé¡¹ç›®æ‰€åœ¨ä½ç½®çš„ &lt;code&gt;.vscode&lt;/code&gt; æ–‡ä»¶å¤¹ä¸­ï¼Œå½“é¡¹ç›®åœ¨ &lt;code&gt;vscode&lt;/code&gt; ä¸­æ‰“å¼€æ—¶ï¼Œé’ˆå¯¹æ‰“å¼€çš„çª—å£ç”Ÿæ•ˆ&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;å¦‚æœåŒæ—¶å­˜åœ¨é¡¹ç›®é…ç½®å’Œç”¨æˆ·é…ç½®ï¼Œå°†ä»¥é¡¹ç›®é…ç½®ä¼˜å…ˆ&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥é€šè¿‡é¡¹ç›®é…ç½®æ–‡ä»¶æ¥å…±äº« &lt;code&gt;vscode&lt;/code&gt; é…ç½®ï¼Œè¾¾åˆ°ç»Ÿä¸€å¼€å‘ç¯å¢ƒçš„ç›®çš„&lt;/p&gt;&lt;h2 id=&quot;åŒæ­¥æ’ä»¶&quot;&gt;&lt;a href=&quot;#åŒæ­¥æ’ä»¶&quot; class=&quot;headerlink&quot; title=&quot;åŒæ­¥æ’ä»¶&quot;&gt;&lt;/a&gt;åŒæ­¥æ’ä»¶&lt;/h2&gt;&lt;p&gt;æ’ä»¶æ–‡ä»¶ &lt;code&gt;extensions.json&lt;/code&gt;&lt;/p&gt;&lt;figure class=&quot;highlight json&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;// ç¤ºä¾‹ä»£ç &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;recommendations&quot;&lt;/span&gt;: [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;dbaeumer.vscode-eslint&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;esbenp.prettier-vscode&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;octref.vetur&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;formulahendry.auto-close-tag&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;formulahendry.auto-rename-tag&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
    
      <category term="å¼€å‘æŠ€å·§" scheme="https://lleohao.github.io/tags/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/"/>
    
  </entry>
  
  <entry>
    <title>å‰ç«¯æ¡†æ¶ä¸­ â€œç±»mixinâ€ æ¨¡å¼çš„æ€è€ƒ</title>
    <link href="https://lleohao.github.io/2018/12/28/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E4%B8%AD%20%E2%80%9C%E7%B1%BBmixin%E2%80%9D%20%E6%A8%A1%E5%BC%8F%E7%9A%84%E6%80%9D%E8%80%83%20/"/>
    <id>https://lleohao.github.io/2018/12/28/å‰ç«¯æ¡†æ¶ä¸­ â€œç±»mixinâ€ æ¨¡å¼çš„æ€è€ƒ /</id>
    <published>2018-12-28T09:22:35.000Z</published>
    <updated>2020-11-24T06:07:16.916Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>â€œç±» mixinâ€ æŒ‡çš„æ˜¯ Vue ä¸­çš„ mixinï¼ŒRegular ä¸­çš„ implement</p></blockquote><h2 id="ä½¿ç”¨-Mixin-çš„ç›®çš„"><a href="#ä½¿ç”¨-Mixin-çš„ç›®çš„" class="headerlink" title="ä½¿ç”¨ Mixin çš„ç›®çš„"></a>ä½¿ç”¨ Mixin çš„ç›®çš„</h2><h3 id="é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ä¸ºä»€ä¹ˆä¼šæœ‰-mixin-çš„å­˜åœ¨ï¼Ÿ"><a href="#é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ä¸ºä»€ä¹ˆä¼šæœ‰-mixin-çš„å­˜åœ¨ï¼Ÿ" class="headerlink" title="é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ä¸ºä»€ä¹ˆä¼šæœ‰ mixin çš„å­˜åœ¨ï¼Ÿ"></a>é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ä¸ºä»€ä¹ˆä¼šæœ‰ <code>mixin</code> çš„å­˜åœ¨ï¼Ÿ</h3><ol><li><p>ä¸ºäº†æ‰©å±•å¯¹è±¡ï¼ˆç»„ä»¶ï¼‰çš„åŠŸèƒ½</p><p>æ‰©å±•å¯¹è±¡åŠŸèƒ½çš„éœ€æ±‚æ˜¯å¾ˆå®¹æ˜“çš„ç†è§£çš„ã€‚æ¯”å¦‚ä¸šåŠ¡å¼€å‘æ—¶ä¼šç¢°åˆ°è·¨æ¨¡å—ä¼ é€’æ¶ˆæ¯çš„éœ€æ±‚ï¼Œå¸¸ç”¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨ â€œå‘å¸ƒ-è®¢é˜…æ¨¡å¼â€ æ¥åˆ›å»ºä¸€ä¸ªå…¨å±€çš„<code>EventEmitter</code>ã€‚ä¸ä½¿ç”¨ <code>mixin</code> æ—¶çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// global/eventEmitter</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EventEmitter</span> </span>&#123;</span><br><span class="line">    on(eventName, handle) &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    emit(eventName) &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ComponentA</span></span><br><span class="line"><span class="keyword">import</span> EventEmitter <span class="keyword">from</span> <span class="string">'global/eventEmitter'</span>; <span class="comment">// å…¨å±€çš„ EventEmitter å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ComponentA</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        EventEmitter.on(<span class="string">'event'</span>, () =&gt; &#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ComponentB</span></span><br><span class="line"><span class="keyword">import</span> EventEmitter <span class="keyword">from</span> <span class="string">'global/eventEmitter'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ComponentB</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        EventEmitter.emit(<span class="string">'event'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦åœ¨ä¸åŒçš„ç»„ä»¶ä¸­å¼•å…¥ <code>EventEmitter</code> æ¥ä½¿ç”¨å®ƒ</p><p>å¦‚æœä½¿ç”¨ <code>mixin</code> çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åš</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// eventEmitter mixin</span></span><br><span class="line"><span class="keyword">import</span> EventEmitter <span class="keyword">from</span> <span class="string">'global/eventEmitter'</span>; <span class="comment">// å…¨å±€çš„ EventEmitter å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> eventEmitterMixin = &#123;</span><br><span class="line">    on: <span class="function">(<span class="params">eventName, handle</span>) =&gt;</span> &#123;EventEmitter.on(eventName, handle)&#125;,</span><br><span class="line">    fire: <span class="function"><span class="params">()</span> =&gt;</span> &#123;EventEmitter.emit(eventName)&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Root Component</span></span><br><span class="line">Component.mixin(eventEmitterMixin);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ComponentA</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ComponentA</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="keyword">this</span>.on(<span class="string">'event'</span>, () =&gt; &#123;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ComponentB</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ComponentB</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="keyword">this</span>.emit(<span class="string">'event'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·é€šè¿‡<code>mixin</code>æ¥æ‰©å±•äº†ç»„ä»¶çš„åŠŸèƒ½ï¼Œæ˜¯æ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥æ–¹ä¾¿çš„ä½¿ç”¨ <code>EventEmitter</code> çš„åŠŸèƒ½</p></li><li><p>ä¸ºäº†å¤ç”¨ä»£ç </p><p>è½¯ä»¶å¼€å‘ä¸­çš„ <code>DRY</code> åŸåˆ™è¿˜æ˜¯æœ‰å¿…è¦éµå®ˆçš„ã€‚è¿‡å¤šçš„é‡å¤ä»£ç ä¼šå¯¼è‡´ç»´æŠ¤ä¸Šçš„éº»çƒ¦ï¼Œé€šè¿‡ <code>mixin</code> ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸åŒçš„å¯¹è±¡ä¸Šä½¿ç”¨åŒä¸€ä»½ä»£ç æ¥å®Œæˆç›¸åŒçš„åŠŸèƒ½ï¼Œå‡è½»æˆ‘ä»¬ç»´æŠ¤çš„å‹åŠ›ã€‚</p></li></ol><a id="more"></a><h3 id="å¤ç”¨-VS-æ‰©å±•"><a href="#å¤ç”¨-VS-æ‰©å±•" class="headerlink" title="å¤ç”¨ VS æ‰©å±•"></a>å¤ç”¨ VS æ‰©å±•</h3><p>å…¶å®è¿™ä¸¤ä¸ªæ²¡æœ‰å¯æ¯”æ€§ï¼Œä½†åœ¨æˆ‘ä»¬å†³å®šæ˜¯å¦éœ€è¦å°†ä¸€ä¸ªå¯¹è±¡é€šè¿‡ <code>mixin</code> çš„æ–¹å¼æ··å…¥åˆ°å…¶ä»–å¯¹è±¡æ—¶å°±åº”è¯¥è€ƒè™‘è¿™ä¸ªé—®é¢˜ã€‚</p><p>åŸåˆ™ä¸Š <strong>å¤ç”¨ &gt; æ‰©å±•</strong>ã€‚</p><p>å¦‚æœä¸€ä¸ª <code>mixin</code> åªæ˜¯ä¸ºäº†æ‰©å±•å•ä¸ªå¯¹è±¡çš„åŠŸèƒ½ï¼Œè€Œæ‰©å±•çš„åŠŸèƒ½å¹¶ä¸èƒ½å¤ç”¨åˆ°å…¶ä»–çš„å¯¹è±¡æ—¶ï¼Œå°±ä¸åº”è¯¥ä½¿ç”¨ <code>mixin</code>ï¼Œè€Œæ˜¯ç›´æ¥å†™åœ¨é‚£ä¸ªå¯¹è±¡ä¸Šæ›´å¥½ã€‚</p><p>å¦‚æœæ‰©å±•çš„åŠŸèƒ½å¯ä»¥è¢«å¤ç”¨çš„è¯ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>mixin</code>ã€‚</p><h2 id="mixin-çš„ç¼ºç‚¹"><a href="#mixin-çš„ç¼ºç‚¹" class="headerlink" title="mixin çš„ç¼ºç‚¹"></a>mixin çš„ç¼ºç‚¹</h2><blockquote><p><a href="https://reactjs.org/blog/2016/07/13/mixins-considered-harmful.html" target="_blank" rel="noopener">mixins-considered-harmful</a> è¿™ç¯‡æ–‡ç« å·²ç»åˆ—ä¸¾äº†ä¸€äº›é—®é¢˜ï¼Œæˆ‘ç®€å•çš„åˆ—ä¸¾ä¸‹</p></blockquote><ol><li><code>mixin</code> ä¼šå¼•å…¥éšæ€§çš„ä¾èµ–å…³ç³»</li><li><code>mixin</code> ä¼šå¯¼è‡´å‘½åå†²çª</li><li><code>mixin</code> ä¼šå¢åŠ é¡¹ç›®çš„å¤æ‚æ€§</li></ol><h2 id="å¦‚ä½•æ­£ç¡®çš„ä½¿ç”¨-Mixin"><a href="#å¦‚ä½•æ­£ç¡®çš„ä½¿ç”¨-Mixin" class="headerlink" title="å¦‚ä½•æ­£ç¡®çš„ä½¿ç”¨ Mixin"></a>å¦‚ä½•æ­£ç¡®çš„ä½¿ç”¨ Mixin</h2><blockquote><p>è™½ç„¶ <code>mixin</code> æœ‰ä¸€äº›ç¼ºç‚¹ï¼Œä½†æ­£ç¡®çš„ä½¿ç”¨è¿˜æ˜¯å¯ä»¥æ–¹ä¾¿æˆ‘ä»¬çš„å¼€å‘</p><p>æ²¡æœ‰ä¸åˆç†çš„è®¾è®¡æ¨¡å¼ï¼Œåªæœ‰ä¸åˆç†çš„ä½¿ç”¨è®¾è®¡æ¨¡å¼</p></blockquote><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦è§£å†³æ··å…¥çš„ <code>mixin</code> å¯èƒ½ä¼šé€ æˆéšæ€§çš„ä¾èµ–å…³ç³»ï¼Œè€Œå½¢æˆè¿™ç§ä¾èµ–å…³ç³»å¤šåŠæ˜¯ <code>mixin</code> ä¸­çš„æ‰©å±•åŠŸèƒ½ä¾èµ–äº†è¢«æ‰©å±•å¯¹è±¡æƒ³å†…éƒ¨æ•°æ®ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸€ä¸ªæ•°æ®åº“æŸ¥çœ‹ç»„ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DatabaseView</span> </span>&#123;</span><br><span class="line">    state = &#123;</span><br><span class="line">        database: [&#123;<span class="attr">name</span>: <span class="string">'db1'</span>, <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">tables</span>: [&#123;<span class="attr">name</span>: <span class="string">'table1'</span>, <span class="attr">id</span>: <span class="number">1</span>&#125;]&#125;]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">DatabaseView.mixin(viewTabelDetails);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠŠæŸ¥çœ‹è¡¨è¯¦æƒ…å¼¹çª—ä½œä¸º mixin æ··å…¥</span></span><br><span class="line"><span class="keyword">const</span> mixin = &#123;</span><br><span class="line">    viewTabelDetails: <span class="function">(<span class="params">dbId, tableId</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> db = <span class="keyword">this</span>.state.database.filter(<span class="function"><span class="params">db</span> =&gt;</span> db.id === dbId)[<span class="number">0</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (db) &#123;</span><br><span class="line">            <span class="keyword">const</span> table = db.tables.filter(<span class="function"><span class="params">table</span> =&gt;</span> table.id === tableId)[<span class="number">0</span>];</span><br><span class="line">       </span><br><span class="line">            <span class="keyword">if</span> (table) &#123;</span><br><span class="line">                Model.show(table);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>mixin</code> ä¾èµ–çš„ <code>DarabaseView</code> ä¸­çš„ <code>database</code> æ•°æ®ã€‚è¿™å°±å¯¼è‡´äº†å¦‚æœé¡µé¢ä¸­å…¶ä»–çš„ç»„ä»¶ä¹Ÿéœ€è¦ä¸€ä¸ªæŸ¥çœ‹è¡¨è¯¦æƒ…å¼¹çª—çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆè¿™ä¸ªç»„ä»¶ä¹Ÿå¿…é¡»æœ‰ç±»ä¼¼çš„ <code>database</code> æ•°æ®ï¼Œå½¢æˆäº†ä¸€ä¸ªéšæ€§çš„ä¾èµ–å…³ç³»ã€‚</p><p>é¿å…çš„æ–¹å¼å°±æ˜¯ <code>mixin</code> å¯¹è±¡ä¸­çš„åŠŸèƒ½ä¸è¦ä¸è¢«æ‰©å±•å¯¹è±¡å‘ç”Ÿä¾èµ–ï¼Œè€Œåœ¨ç»„ä»¶å¼€å‘ä¸­è¿™ä¸ªä¾èµ–å¤šåŠå°±æ˜¯ä½¿ç”¨äº†è¢«æ‰©å±•å¯¹è±¡çš„ <code>state</code> äº§ç”Ÿçš„</p><p>è‡³äºå‘½åå†²çªå’Œå¢åŠ é¡¹ç›®çš„å¤æ‚æ€§å¯ä»¥é€šè¿‡å…¶ä»–çš„æ–¹å¼è§£å†³ï¼Œç›¸æ¯”äºä¸Šé¢çš„é—®é¢˜è¿˜ç®—ç®€å•</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol><li><code>mixin</code> åªæ˜¯ç”¨æ¥æ‰©å±•å¯¹è±¡åŠŸèƒ½çš„ï¼Œè€Œä¸”è¿™ä¸ªæ‰©å±•åŠŸèƒ½æ˜¯å¯ä»¥è¢«å¤ç”¨çš„ï¼Œå¦åˆ™ä½ åº”è¯¥ç›´æ¥å†™åœ¨å¯¹è±¡é‡Œé¢</li><li>æ‰©å±•åŠŸèƒ½çš„åŒæ—¶ï¼Œ<code>mixin</code>æä¾›çš„å‡½æ•°<strong>ä¸åº”è¯¥ä¾èµ–è¢«æ‰©å±•å¯¹è±¡çš„å†…éƒ¨æ•°æ®</strong>ã€‚å› ä¸ºå¦‚æœä¾èµ–çš„è¢«æ‰©å±•å¯¹è±¡çš„å†…éƒ¨æ•°æ®ï¼Œä¼šä½¿è¿™ä¸ª <code>mixin</code> åªèƒ½è¢«åŒ…å«ç‰¹å®šæ•°æ®å¯¹è±¡çš„å¯¹è±¡å¤ç”¨ï¼Œå½±å“ <code>mixin</code> çš„å¤ç”¨</li></ol><h2 id="ä¸ªäººä¸»è§‚è§‚ç‚¹"><a href="#ä¸ªäººä¸»è§‚è§‚ç‚¹" class="headerlink" title="ä¸ªäººä¸»è§‚è§‚ç‚¹"></a>ä¸ªäººä¸»è§‚è§‚ç‚¹</h2><p>å…¶å®æˆ‘è§‰å¾—åœ¨å‰ç«¯çš„å¼€å‘ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥é¿å…ä½¿ç”¨ <code>mixin</code> å»æ‰©å±•ç»„ä»¶çš„åŠŸèƒ½</p><p>ä¾‹å¦‚æˆ‘ä»¬å®Œå…¨å¯ä»¥ä½¿ç”¨å‡½æ•°è°ƒç”¨ï¼ˆæ˜¾æ€§çš„ï¼‰å»è°ƒç”¨ <code>mixin</code> å¯¹è±¡ä¸­çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯ä¸€è‚¡è„‘çš„å°† <code>mixin</code> å¯¹è±¡æ··åˆåˆ°ç»„ä»¶ä¸­</p><p>æ¯æ¬¡ä¿®æ”¹ä½¿ç”¨äº† <code>implement</code> ç»„ä»¶éƒ½ä¼šç‰¹åˆ«ç—›è‹¦ï¼ˆè¿™æ ·å¯¼å…¥çš„æ–¹æ³• WebStorm æ ¹æœ¬ä¸è¯†åˆ«ï¼‰ï¼Œæå¤§äº†å¢åŠ ç»´æŠ¤çš„å·¥ä½œé‡ã€‚åŒæ—¶ç”±äºæœ‰çš„ <code>mixin</code> å¯¹è±¡ä¾èµ–çš„è¢«æ‰©å±•å¯¹è±¡çš„å†…éƒ¨æ•°æ®ï¼Œå¯¼è‡´æƒ³å¤ç”¨çš„è¯è¿˜å¾—æœ‰ç›¸åŒçš„æ•°æ®ç»“æ„ï¼ˆé‚£è¿˜å¤ç”¨ä¸ªé”¤å­å•Šï¼‰</p><p>æ‰€ä»¥ï¼Œä¸è¦ç”¨ <code>mixin</code> ï¼ï¼ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;â€œç±» mixinâ€ æŒ‡çš„æ˜¯ Vue ä¸­çš„ mixinï¼ŒRegular ä¸­çš„ implement&lt;/p&gt;
&lt;/blockquote&gt;&lt;h2 id=&quot;ä½¿ç”¨-Mixin-çš„ç›®çš„&quot;&gt;&lt;a href=&quot;#ä½¿ç”¨-Mixin-çš„ç›®çš„&quot; class=&quot;headerlink&quot; title=&quot;ä½¿ç”¨ Mixin çš„ç›®çš„&quot;&gt;&lt;/a&gt;ä½¿ç”¨ Mixin çš„ç›®çš„&lt;/h2&gt;&lt;h3 id=&quot;é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ä¸ºä»€ä¹ˆä¼šæœ‰-mixin-çš„å­˜åœ¨ï¼Ÿ&quot;&gt;&lt;a href=&quot;#é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ä¸ºä»€ä¹ˆä¼šæœ‰-mixin-çš„å­˜åœ¨ï¼Ÿ&quot; class=&quot;headerlink&quot; title=&quot;é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ä¸ºä»€ä¹ˆä¼šæœ‰ mixin çš„å­˜åœ¨ï¼Ÿ&quot;&gt;&lt;/a&gt;é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ä¸ºä»€ä¹ˆä¼šæœ‰ &lt;code&gt;mixin&lt;/code&gt; çš„å­˜åœ¨ï¼Ÿ&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;ä¸ºäº†æ‰©å±•å¯¹è±¡ï¼ˆç»„ä»¶ï¼‰çš„åŠŸèƒ½&lt;/p&gt;
&lt;p&gt;æ‰©å±•å¯¹è±¡åŠŸèƒ½çš„éœ€æ±‚æ˜¯å¾ˆå®¹æ˜“çš„ç†è§£çš„ã€‚æ¯”å¦‚ä¸šåŠ¡å¼€å‘æ—¶ä¼šç¢°åˆ°è·¨æ¨¡å—ä¼ é€’æ¶ˆæ¯çš„éœ€æ±‚ï¼Œå¸¸ç”¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨ â€œå‘å¸ƒ-è®¢é˜…æ¨¡å¼â€ æ¥åˆ›å»ºä¸€ä¸ªå…¨å±€çš„&lt;code&gt;EventEmitter&lt;/code&gt;ã€‚ä¸ä½¿ç”¨ &lt;code&gt;mixin&lt;/code&gt; æ—¶çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// global/eventEmitter&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;EventEmitter&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    on(eventName, handle) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    emit(eventName) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ComponentA&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; EventEmitter &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;global/eventEmitter&#39;&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// å…¨å±€çš„ EventEmitter å¯¹è±¡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ComponentA&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;constructor&lt;/span&gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        EventEmitter.on(&lt;span class=&quot;string&quot;&gt;&#39;event&#39;&lt;/span&gt;, () =&amp;gt; &amp;#123;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ComponentB&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; EventEmitter &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;global/eventEmitter&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ComponentB&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;constructor&lt;/span&gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        EventEmitter.emit(&lt;span class=&quot;string&quot;&gt;&#39;event&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;æˆ‘ä»¬éœ€è¦åœ¨ä¸åŒçš„ç»„ä»¶ä¸­å¼•å…¥ &lt;code&gt;EventEmitter&lt;/code&gt; æ¥ä½¿ç”¨å®ƒ&lt;/p&gt;
&lt;p&gt;å¦‚æœä½¿ç”¨ &lt;code&gt;mixin&lt;/code&gt; çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åš&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// eventEmitter mixin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; EventEmitter &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;global/eventEmitter&#39;&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// å…¨å±€çš„ EventEmitter å¯¹è±¡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; eventEmitterMixin = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    on: &lt;span class=&quot;function&quot;&gt;(&lt;span class=&quot;params&quot;&gt;eventName, handle&lt;/span&gt;) =&amp;gt;&lt;/span&gt; &amp;#123;EventEmitter.on(eventName, handle)&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fire: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; &amp;#123;EventEmitter.emit(eventName)&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Root Component&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Component.mixin(eventEmitterMixin);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ComponentA&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ComponentA&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;constructor&lt;/span&gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.on(&lt;span class=&quot;string&quot;&gt;&#39;event&#39;&lt;/span&gt;, () =&amp;gt; &amp;#123;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ComponentB&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ComponentB&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;constructor&lt;/span&gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.emit(&lt;span class=&quot;string&quot;&gt;&#39;event&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;è¿™æ ·é€šè¿‡&lt;code&gt;mixin&lt;/code&gt;æ¥æ‰©å±•äº†ç»„ä»¶çš„åŠŸèƒ½ï¼Œæ˜¯æ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥æ–¹ä¾¿çš„ä½¿ç”¨ &lt;code&gt;EventEmitter&lt;/code&gt; çš„åŠŸèƒ½&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¸ºäº†å¤ç”¨ä»£ç &lt;/p&gt;
&lt;p&gt;è½¯ä»¶å¼€å‘ä¸­çš„ &lt;code&gt;DRY&lt;/code&gt; åŸåˆ™è¿˜æ˜¯æœ‰å¿…è¦éµå®ˆçš„ã€‚è¿‡å¤šçš„é‡å¤ä»£ç ä¼šå¯¼è‡´ç»´æŠ¤ä¸Šçš„éº»çƒ¦ï¼Œé€šè¿‡ &lt;code&gt;mixin&lt;/code&gt; ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸åŒçš„å¯¹è±¡ä¸Šä½¿ç”¨åŒä¸€ä»½ä»£ç æ¥å®Œæˆç›¸åŒçš„åŠŸèƒ½ï¼Œå‡è½»æˆ‘ä»¬ç»´æŠ¤çš„å‹åŠ›ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
    
    
      <category term="å‰ç«¯" scheme="https://lleohao.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://lleohao.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ HTTP2 åšå¼€å‘æœåŠ¡å™¨ (ä¸Š)</title>
    <link href="https://lleohao.github.io/2018/03/27/%E4%BD%BF%E7%94%A8-HTTP2-%E5%81%9A%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%20(%E4%B8%8A)/"/>
    <id>https://lleohao.github.io/2018/03/27/ä½¿ç”¨-HTTP2-åšå¼€å‘æœåŠ¡å™¨ (ä¸Š)/</id>
    <published>2018-03-27T01:50:00.000Z</published>
    <updated>2020-11-24T06:07:16.912Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å†™ä½œèƒŒæ™¯"><a href="#å†™ä½œèƒŒæ™¯" class="headerlink" title="å†™ä½œèƒŒæ™¯"></a>å†™ä½œèƒŒæ™¯</h2><p>ç¬”è€…æ‰€åœ¨é¡¹ç›®ä½¿ç”¨çš„å‰ç«¯æŠ€æœ¯æ¯”è¾ƒè€æ—§ï¼Œåœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­éœ€è¦å…ˆå¯åŠ¨ä¸€ä¸ªåç«¯é¡¹ç›® (tomcat + mysql + redis) æ¥åšä¸ºé™æ€æœåŠ¡å™¨</p><p>ç„¶åä½¿ç”¨çš„æ˜¯ä¸€ä¸ªå…¬å¸å†…éƒ¨çš„ç±»AMDæ¨¡å—åŠ è½½å·¥å…·ï¼Œæ¯æ¬¡åˆ·æ–°é¡µé¢éƒ½è¦åŠ è½½1000+ çš„æ–‡ä»¶ï¼Œé¡µé¢çš„å“åº”æ—¶é—´æ¥è¿‘20sï¼Œ å¯¼è‡´å¼€å‘çš„è¿‡ç¨‹éå¸¸ç—›è‹¦</p><p>æ‰€ä»¥å†³å®šä½¿ç”¨ HTTP/2 æ¥å¼€å‘ä¸€ä¸ªå¼€å‘æœåŠ¡å™¨æ¥åŠ å¿«é¡µé¢çš„åŠ è½½é€Ÿåº¦. ç›®å‰æ¥è¯´æ•ˆæœä¸é”™ï¼Œç›¸å¯¹äº HTTP1.1 æ¥è¯´åŠ è½½<strong>é€Ÿåº¦æå‡äº† 50%</strong>ã€‚</p><p>å¯¹äºå¼€å‘ç¯å¢ƒä¸æˆ‘ä»¬ç±»ä¼¼çš„é¡¹ç›®ï¼Œå¯ä»¥å°è¯•ä¸€ä¸‹ã€‚</p><h2 id="ç†è®ºåŸºç¡€"><a href="#ç†è®ºåŸºç¡€" class="headerlink" title="ç†è®ºåŸºç¡€"></a>ç†è®ºåŸºç¡€</h2><h3 id="1-HTTP-2-çš„TCPè¿æ¥å¤ç”¨"><a href="#1-HTTP-2-çš„TCPè¿æ¥å¤ç”¨" class="headerlink" title="1. HTTP/2 çš„TCPè¿æ¥å¤ç”¨"></a>1. HTTP/2 çš„TCPè¿æ¥å¤ç”¨</h3><p>è™½ç„¶æˆ‘ä»¬å¼€å‘çš„æ—¶å€™ä½¿ç”¨çš„æ˜¯æœ¬åœ°æœåŠ¡å™¨ï¼Œå»ºç«‹è¿æ¥çš„é€Ÿåº¦å’Œä¸‹è½½é€Ÿåº¦éƒ½å¾ˆå¿«ï¼Œä½†æ˜¯æµè§ˆå™¨é’ˆå¯¹åŒä¸€åŸŸåçš„å¹¶å‘è¯·æ±‚æ˜¯æœ‰ä¸Šé™çš„ã€‚</p><a id="more"></a><p>å½“æ‰€éœ€è¦çš„æ–‡ä»¶æ•°é‡å¾ˆå¤šæ—¶ï¼Œæˆ‘ä»¬æ¯æ¬¡åªèƒ½è¯·æ±‚ä¸€å®šæ•°é‡çš„æ–‡ä»¶ï¼Œå½“å‰é¢çš„æ–‡ä»¶çš„è¯·æ±‚å®Œæˆåæ‰èƒ½å»è¯·æ±‚ä¸‹ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™å°±é€ æˆäº†å µå¡ã€‚</p><p><img src="./http2-1.png" alt></p><p><em>ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜æ˜¾çš„é“¾æ¥é™åˆ¶å’Œå µå¡</em></p><p>è€Œ HTTP/2 å¯ä»¥åœ¨åŒä¸€è¿æ¥ä¸Šè¿›è¡Œå¤šä¸ªå¹¶å‘äº¤æ¢ï¼Œå¯ä»¥é¿å…å‡ºç°å› ä¸ºæµè§ˆå™¨çš„å¹¶å‘é™åˆ¶è€Œé€ æˆçš„å µå¡</p><blockquote><p>HTTP/2 é€šè¿‡æ”¯æŒæ ‡å¤´å­—æ®µå‹ç¼©å’Œåœ¨åŒä¸€è¿æ¥ä¸Šè¿›è¡Œå¤šä¸ªå¹¶å‘äº¤æ¢ï¼Œè®©åº”ç”¨æ›´æœ‰æ•ˆåœ°åˆ©ç”¨ç½‘ç»œèµ„æºï¼Œå‡å°‘æ„ŸçŸ¥çš„å»¶è¿Ÿæ—¶é—´ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒå¯ä»¥å¯¹åŒä¸€è¿æ¥ä¸Šçš„è¯·æ±‚å’Œå“åº”æ¶ˆæ¯è¿›è¡Œäº¤é”™å‘é€å¹¶ä¸º HTTP æ ‡å¤´å­—æ®µä½¿ç”¨æœ‰æ•ˆç¼–ç ã€‚ HTTP/2 è¿˜å…è®¸ä¸ºè¯·æ±‚è®¾ç½®ä¼˜å…ˆçº§ï¼Œè®©æ›´é‡è¦çš„è¯·æ±‚æ›´å¿«é€Ÿåœ°å®Œæˆï¼Œä»è€Œè¿›ä¸€æ­¥æå‡æ€§èƒ½ã€‚å‡ºå°çš„åè®®å¯¹ç½‘ç»œæ›´åŠ å‹å¥½ï¼Œå› ä¸ºä¸ HTTP/1.x ç›¸æ¯”ï¼Œå¯ä»¥ä½¿ç”¨æ›´å°‘çš„ TCP è¿æ¥ã€‚ è¿™æ„å‘³ç€ä¸å…¶ä»–æµçš„ç«äº‰å‡å°ï¼Œå¹¶ä¸”è¿æ¥çš„æŒç»­æ—¶é—´å˜é•¿ï¼Œè¿™äº›ç‰¹æ€§åè¿‡æ¥æé«˜äº†å¯ç”¨ç½‘ç»œå®¹é‡çš„åˆ©ç”¨ç‡ã€‚ æœ€åï¼ŒHTTP/2 è¿˜å¯ä»¥é€šè¿‡ä½¿ç”¨äºŒè¿›åˆ¶æ¶ˆæ¯åˆ†å¸§å¯¹æ¶ˆæ¯è¿›è¡Œæ›´é«˜æ•ˆçš„å¤„ç†ã€‚ï¼ˆè¶…æ–‡æœ¬ä¼ è¾“åè®®ç‰ˆæœ¬ 2ï¼Œè‰æ¡ˆ 17ï¼‰ - <a href="https://developers.google.com/web/fundamentals/performance/http2/?hl=zh-cn" target="_blank" rel="noopener">https://developers.google.com/web/fundamentals/performance/http2/?hl=zh-cn</a></p></blockquote><h3 id="2-Server-Push-æœåŠ¡å™¨æ¨é€"><a href="#2-Server-Push-æœåŠ¡å™¨æ¨é€" class="headerlink" title="2. Server Push æœåŠ¡å™¨æ¨é€"></a>2. Server Push æœåŠ¡å™¨æ¨é€</h3><p>HTTP/2 ä¸­æœ€ä»¤äººæœŸå¾…çš„ç‰¹æ€§å°±æ˜¯ Sever Push (æœåŠ¡å™¨æ¨é€)ã€‚</p><p>é€šè¿‡ Server Pushï¼ŒæœåŠ¡å™¨å¯ä»¥å¯¹æµè§ˆå™¨çš„<strong>å•ä¸ªè¯·æ±‚è¿”å›å¤šä¸ªå“åº”</strong>ï¼Œè€Œä¸éœ€è¦ç­‰å¾…æµè§ˆå™¨å‘å‡ºè¯·æ±‚å†ç»™å»å“åº”ã€‚</p><p>ç®€å•ä¸¾ä¸ªğŸŒ°</p><ol><li>æµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€ a.com è¯·æ±‚</li><li>æœåŠ¡å™¨ç¡®å®šè¿™ä¸ªè¯·æ±‚è¿”å›ä¸€ä¸ª index.html æ–‡ä»¶ï¼ŒåŒæ—¶å‘ç°è¿™ä¸ªæ–‡ä»¶éœ€è¦ style.css å’Œ script.js æ–‡ä»¶</li><li>æœåŠ¡å™¨å‘æµè§ˆå™¨æ”¾å›  index.html çš„å“åº”ï¼ŒåŒæ—¶å‘Šè¯‰æµè§ˆå™¨æˆ‘è¿™é‡Œæœ‰ style.css å’Œ script.js æ–‡ä»¶ä½ å¯èƒ½éœ€è¦</li><li>æµè§ˆå™¨æ”¶åˆ° index.html åï¼Œè§£æåå‘ç°éœ€è¦ style.css å’Œ script.jsï¼Œæ­£å¥½æœåŠ¡å™¨ç«¯è¯´å¯ä»¥æ¨é€è¿™ä¸¤ä¸ªèµ„æºï¼Œæµè§ˆå™¨å°±ä¸éœ€è¦å†æ¬¡å‘é€è¯·æ±‚å»è·å–ï¼Œè€Œæ˜¯ç›´æ¥å°±æ”¶æœåŠ¡å™¨çš„æ¨é€</li></ol><p>ç»“åˆä¸Šé¢çš„è¿æ¥å¤ç”¨ï¼ŒHTTP/2 å¯ä»¥æå¤§çš„åŠ å¿«èµ„æºæ–‡ä»¶çš„åŠ è½½é€Ÿåº¦</p><p><img src="./http2-2.png" alt></p><p><em>å¯ä»¥çœ‹åˆ°æµè§ˆå™¨ä½¿ç”¨ä¸€ä¸ªé“¾æ¥åŠ è½½å®Œäº†æ‰€æœ‰çš„èµ„æºæ–‡ä»¶</em></p><h2 id="Nodejs-HTTP-2-æ¨¡å—ç®€å•ä½¿ç”¨"><a href="#Nodejs-HTTP-2-æ¨¡å—ç®€å•ä½¿ç”¨" class="headerlink" title="Nodejs HTTP/2 æ¨¡å—ç®€å•ä½¿ç”¨"></a>Nodejs HTTP/2 æ¨¡å—ç®€å•ä½¿ç”¨</h2><blockquote><p>è¿™é‡Œå…ˆç®€å•ä»‹ç»ä¸‹ Node ä¸­ HTTP/2 çš„ä½¿ç”¨ï¼Œä¸‹ç¯‡æ–‡ç« å°†è¯¦ç»†é˜è¿°å¦‚ä½•ç¼–å†™ä¸€ä¸ªå¯ä»¥åº”ç”¨çš„ HTTP/2 å¼€å‘æœåŠ¡å™¨</p></blockquote><h3 id="1-åˆ›å»º-HTTPS-è¯ä¹¦"><a href="#1-åˆ›å»º-HTTPS-è¯ä¹¦" class="headerlink" title="1. åˆ›å»º HTTPS è¯ä¹¦"></a>1. åˆ›å»º HTTPS è¯ä¹¦</h3><p>ç”±äº HTTP/2 éœ€è¦ä½¿ç”¨ HTTPSï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦å…ˆç”Ÿæˆä¸€ä¸ªè¯ä¹¦ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl req -x509 -newkey rsa:2048 -nodes -sha256 -subj '/CN=localhost' \</span><br><span class="line">  -keyout localhost-privkey.pem -out localhost-cert.pem</span><br></pre></td></tr></table></figure><h3 id="2-é¡¹ç›®ç»“æ„"><a href="#2-é¡¹ç›®ç»“æ„" class="headerlink" title="2. é¡¹ç›®ç»“æ„"></a>2. é¡¹ç›®ç»“æ„</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ certificate</span><br><span class="line">â”‚   â”œâ”€â”€ localhost-cert.pem</span><br><span class="line">â”‚   â””â”€â”€ localhost-privkey.pem</span><br><span class="line">â”œâ”€â”€ node_modules</span><br><span class="line">â”œâ”€â”€ package-lock.json</span><br><span class="line">â”œâ”€â”€ package.json</span><br><span class="line">â”œâ”€â”€ src</span><br><span class="line">â”‚   â””â”€â”€ app.js</span><br><span class="line">â””â”€â”€ www</span><br><span class="line">    â”œâ”€â”€ index.html</span><br><span class="line">    â”œâ”€â”€ script.js</span><br><span class="line">    â””â”€â”€ styles.css</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- www/index.html --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>HTTP2 demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"styles.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"content"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"script.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// www/script.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> content = <span class="built_in">document</span>.querySelector(<span class="string">"#content"</span>);</span><br><span class="line"></span><br><span class="line">content.innerHTML = <span class="string">`&lt;h1&gt;Hello HTTP/2&lt;/h1&gt;`</span>;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* www/styles.css */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">h1</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: cornflowerblue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºå¦‚ä¸Šçš„é¡¹ç›®ç»“æ„</p><h2 id="3-åˆ›å»ºæœåŠ¡å™¨"><a href="#3-åˆ›å»ºæœåŠ¡å™¨" class="headerlink" title="3. åˆ›å»ºæœåŠ¡å™¨"></a>3. åˆ›å»ºæœåŠ¡å™¨</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http2 = <span class="built_in">require</span>(<span class="string">"http2"</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http2.createSecureServer(&#123;</span><br><span class="line">  key: fs.readFileSync(</span><br><span class="line">    path.resolve(__dirname, <span class="string">"../certificate/localhost-privkey.pem"</span>)</span><br><span class="line">  ),</span><br><span class="line">  cert: fs.readFileSync(</span><br><span class="line">    path.resolve(__dirname, <span class="string">"../certificate/localhost-cert.pem"</span>)</span><br><span class="line">  )</span><br><span class="line">&#125;);</span><br><span class="line">server.on(<span class="string">"error"</span>, err =&gt; <span class="built_in">console</span>.error(err));</span><br><span class="line"></span><br><span class="line">server.on(<span class="string">"stream"</span>, (stream, headers) =&gt; &#123;</span><br><span class="line">  <span class="comment">// stream is a Duplex</span></span><br><span class="line">  stream.respond(&#123;</span><br><span class="line">    <span class="string">"content-type"</span>: <span class="string">"text/html"</span>,</span><br><span class="line">    <span class="string">":status"</span>: <span class="number">200</span></span><br><span class="line">  &#125;);</span><br><span class="line">  stream.end(<span class="string">"&lt;h1&gt;Hello World&lt;/h1&gt;"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">8443</span>);</span><br></pre></td></tr></table></figure><p>æ‰“å¼€æ§åˆ¶å°ï¼Œè¿›å…¥ Network ï¼Œå¼€å¯ Protocol æ˜¾ç¤º</p><p><img src="./http-3.png" alt></p><p>è®¿é—® <a href="https://localhost:8443/" target="_blank" rel="noopener">https://localhost:8443/</a> ï¼Œå³å¯çœ‹åˆ°åè®®å˜ä¸º <code>h2</code></p><p><img src="./http2-4.png" alt></p><h3 id="4-å¯ç”¨æœåŠ¡å™¨ç«¯æ¨é€"><a href="#4-å¯ç”¨æœåŠ¡å™¨ç«¯æ¨é€" class="headerlink" title="4. å¯ç”¨æœåŠ¡å™¨ç«¯æ¨é€"></a>4. å¯ç”¨æœåŠ¡å™¨ç«¯æ¨é€</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http2 = <span class="built_in">require</span>(<span class="string">"http2"</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> pemPath = path.resolve(__dirname, <span class="string">"../certificate/localhost-privkey.pem"</span>);</span><br><span class="line"><span class="keyword">const</span> certPaht = path.resolve(__dirname, <span class="string">"../certificate/localhost-cert.pem"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å– HTTP2 header å¸¸é‡</span></span><br><span class="line"><span class="keyword">const</span> &#123; HTTP2_HEADER_PATH, HTTP2_HEADER_STATUS &#125; = http2.constants;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–é™æ€ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¿¡æ¯</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createFileInfoMap</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> fileInfoMap = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">  <span class="keyword">const</span> fileList = fs.readdirSync(staticPath);</span><br><span class="line">  <span class="keyword">const</span> contentTypeMap = &#123;</span><br><span class="line">    js: <span class="string">"application/javascript"</span>,</span><br><span class="line">    css: <span class="string">"text/css"</span>,</span><br><span class="line">    html: <span class="string">"text/html"</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  fileList.forEach(<span class="function"><span class="params">file</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> fd = fs.openSync(path.resolve(staticPath, file), <span class="string">"r"</span>);</span><br><span class="line">    <span class="keyword">const</span> contentType = contentTypeMap[file.split(<span class="string">"."</span>)[<span class="number">1</span>]];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> stat = fs.fstatSync(fd);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> headers = &#123;</span><br><span class="line">      <span class="string">"content-length"</span>: stat.size,</span><br><span class="line">      <span class="string">"last-modified"</span>: stat.mtime.toUTCString(),</span><br><span class="line">      <span class="string">"content-type"</span>: contentType</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    fileInfoMap.set(<span class="string">`/<span class="subst">$&#123;file&#125;</span>`</span>, &#123;</span><br><span class="line">      fd,</span><br><span class="line">      headers</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> fileInfoMap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰é™æ€ç›®å½•</span></span><br><span class="line"><span class="keyword">const</span> staticPath = path.resolve(__dirname, <span class="string">"../www"</span>);</span><br><span class="line"><span class="keyword">const</span> fileInfoMap = createFileInfoMap();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†ä¼ å…¥çš„æ–‡ä»¶æ¨é€åˆ°æµè§ˆå™¨</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push</span>(<span class="params">stream, path</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> file = fileInfoMap.get(path);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!file) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  stream.pushStream(&#123; [HTTP2_HEADER_PATH]: path &#125;, (err, pushStream) =&gt; &#123;</span><br><span class="line">    pushStream.respondWithFD(file.fd, file.headers);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http2.createSecureServer(&#123;</span><br><span class="line">  key: fs.readFileSync(pemPath),</span><br><span class="line">  cert: fs.readFileSync(certPaht)</span><br><span class="line">&#125;);</span><br><span class="line">server.on(<span class="string">"error"</span>, err =&gt; <span class="built_in">console</span>.error(err));</span><br><span class="line"></span><br><span class="line">server.on(<span class="string">"stream"</span>, (stream, headers) =&gt; &#123;</span><br><span class="line">  <span class="comment">// è·å–è¯·æ±‚è·¯å¾„</span></span><br><span class="line">  <span class="keyword">let</span> requestPath = headers[HTTP2_HEADER_PATH];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¯·æ±‚åˆ° '/' çš„è¯·æ±‚è¿”å› index.html</span></span><br><span class="line">  <span class="keyword">if</span> (requestPath === <span class="string">"/"</span>) &#123;</span><br><span class="line">    requestPath = <span class="string">"/index.html"</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ ¹æ®è¯·æ±‚è·¯å¾„è·å–å¯¹åº”çš„æ–‡ä»¶ä¿¡æ¯</span></span><br><span class="line">  <span class="keyword">const</span> fileInfo = fileInfoMap.get(requestPath);</span><br><span class="line">  <span class="keyword">if</span> (!fileInfo) &#123;</span><br><span class="line">    stream.respond(&#123;</span><br><span class="line">      [HTTP2_HEADER_STATUS]: <span class="number">404</span></span><br><span class="line">    &#125;);</span><br><span class="line">    stream.end(<span class="string">"Not found"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è®¿é—®é¦–é¡µæ—¶åŒæ—¶æ¨é€å…¶ä»–æ–‡ä»¶èµ„æº</span></span><br><span class="line">  <span class="keyword">if</span> (requestPath === <span class="string">"/index.html"</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> fileInfoMap.keys()) &#123;</span><br><span class="line">      push(stream, key);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ¨é€é¦–é¡µæ•°æ®</span></span><br><span class="line">  stream.respondWithFD(fileInfo.fd, &#123;</span><br><span class="line">    ...fileInfo.headers</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">8443</span>);</span><br></pre></td></tr></table></figure><p>è®¿é—® <a href="https://localhost:8443" target="_blank" rel="noopener">https://localhost:8443</a> å°±å¯ä»¥çœ‹åˆ° styles.css å’Œ script.js æ˜¯é€šè¿‡ HTTP/2 æ¨é€è¿‡æ¥çš„</p><p><img src="./http2-6.png" alt></p><h2 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h2><ol><li><a href="https://developers.google.com/web/fundamentals/performance/http2/?hl=zh-cn#_4" target="_blank" rel="noopener">HTTP/2 ç®€ä»‹  |  Web  |  Google Developers</a></li><li><a href="http://www.alloyteam.com/2017/04/guide-http2-server-push-part1/" target="_blank" rel="noopener">HTTP/2 Server Push è¯¦è§£ï¼ˆä¸Šï¼‰ | AlloyTeam</a></li><li><a href="http://www.alloyteam.com/2017/04/guide-http2-server-push-part2/" target="_blank" rel="noopener">HTTP/2 Server Push è¯¦è§£ï¼ˆä¸‹ï¼‰ | AlloyTeam</a></li><li><a href="./node-http2-demo.zip">demo ä¸‹è½½åœ°å€</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å†™ä½œèƒŒæ™¯&quot;&gt;&lt;a href=&quot;#å†™ä½œèƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;å†™ä½œèƒŒæ™¯&quot;&gt;&lt;/a&gt;å†™ä½œèƒŒæ™¯&lt;/h2&gt;&lt;p&gt;ç¬”è€…æ‰€åœ¨é¡¹ç›®ä½¿ç”¨çš„å‰ç«¯æŠ€æœ¯æ¯”è¾ƒè€æ—§ï¼Œåœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­éœ€è¦å…ˆå¯åŠ¨ä¸€ä¸ªåç«¯é¡¹ç›® (tomcat + mysql + redis) æ¥åšä¸ºé™æ€æœåŠ¡å™¨&lt;/p&gt;&lt;p&gt;ç„¶åä½¿ç”¨çš„æ˜¯ä¸€ä¸ªå…¬å¸å†…éƒ¨çš„ç±»AMDæ¨¡å—åŠ è½½å·¥å…·ï¼Œæ¯æ¬¡åˆ·æ–°é¡µé¢éƒ½è¦åŠ è½½1000+ çš„æ–‡ä»¶ï¼Œé¡µé¢çš„å“åº”æ—¶é—´æ¥è¿‘20sï¼Œ å¯¼è‡´å¼€å‘çš„è¿‡ç¨‹éå¸¸ç—›è‹¦&lt;/p&gt;&lt;p&gt;æ‰€ä»¥å†³å®šä½¿ç”¨ HTTP/2 æ¥å¼€å‘ä¸€ä¸ªå¼€å‘æœåŠ¡å™¨æ¥åŠ å¿«é¡µé¢çš„åŠ è½½é€Ÿåº¦. ç›®å‰æ¥è¯´æ•ˆæœä¸é”™ï¼Œç›¸å¯¹äº HTTP1.1 æ¥è¯´åŠ è½½&lt;strong&gt;é€Ÿåº¦æå‡äº† 50%&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;p&gt;å¯¹äºå¼€å‘ç¯å¢ƒä¸æˆ‘ä»¬ç±»ä¼¼çš„é¡¹ç›®ï¼Œå¯ä»¥å°è¯•ä¸€ä¸‹ã€‚&lt;/p&gt;&lt;h2 id=&quot;ç†è®ºåŸºç¡€&quot;&gt;&lt;a href=&quot;#ç†è®ºåŸºç¡€&quot; class=&quot;headerlink&quot; title=&quot;ç†è®ºåŸºç¡€&quot;&gt;&lt;/a&gt;ç†è®ºåŸºç¡€&lt;/h2&gt;&lt;h3 id=&quot;1-HTTP-2-çš„TCPè¿æ¥å¤ç”¨&quot;&gt;&lt;a href=&quot;#1-HTTP-2-çš„TCPè¿æ¥å¤ç”¨&quot; class=&quot;headerlink&quot; title=&quot;1. HTTP/2 çš„TCPè¿æ¥å¤ç”¨&quot;&gt;&lt;/a&gt;1. HTTP/2 çš„TCPè¿æ¥å¤ç”¨&lt;/h3&gt;&lt;p&gt;è™½ç„¶æˆ‘ä»¬å¼€å‘çš„æ—¶å€™ä½¿ç”¨çš„æ˜¯æœ¬åœ°æœåŠ¡å™¨ï¼Œå»ºç«‹è¿æ¥çš„é€Ÿåº¦å’Œä¸‹è½½é€Ÿåº¦éƒ½å¾ˆå¿«ï¼Œä½†æ˜¯æµè§ˆå™¨é’ˆå¯¹åŒä¸€åŸŸåçš„å¹¶å‘è¯·æ±‚æ˜¯æœ‰ä¸Šé™çš„ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>åœ¨ Heroku ä¸Šå¼€å‘ã€éƒ¨ç½²Nodeç¨‹åºçš„å¿«é€ŸæŒ‡å—</title>
    <link href="https://lleohao.github.io/2018/03/25/%E5%9C%A8-Heroku-%E4%B8%8A%E5%BC%80%E5%8F%91%E3%80%81%E9%83%A8%E7%BD%B2Node%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%BF%AB%E9%80%9F%E6%8C%87%E5%8D%97/"/>
    <id>https://lleohao.github.io/2018/03/25/åœ¨-Heroku-ä¸Šå¼€å‘ã€éƒ¨ç½²Nodeç¨‹åºçš„å¿«é€ŸæŒ‡å—/</id>
    <published>2018-03-25T04:14:41.000Z</published>
    <updated>2020-11-24T06:07:16.916Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å°è¯•ä½¿ç”¨äº†ä¸‹Heroku, åœ¨ä¸Šé¢éƒ¨ç½² Node ç¨‹åºè¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„, ä¸»è¦ä¼˜åŠ¿åœ¨äºå®ƒçš„ç½‘ç»œå¯ä»¥è®¿é—®åˆ°å¤–ç½‘, å…·ä½“åº”ç”¨éƒ½æ‡‚å¾—</p><p>è¿™é‡Œè®°å½•ä¸‹å¦‚ä½•åœ¨ Heroku ä¸Šåˆ›å»ºã€å¼€å‘ã€éƒ¨ç½² Node </p><p><a href="https://devcenter.heroku.com/articles/getting-started-with-nodejs#introduction" target="_blank" rel="noopener">å®˜æ–¹çš„æ–‡æ¡£åœ¨è¿™é‡Œ</a></p></blockquote><h2 id="å®‰è£…-Heroku-cli"><a href="#å®‰è£…-Heroku-cli" class="headerlink" title="å®‰è£… Heroku cli"></a>å®‰è£… Heroku cli</h2><ul><li><a href="https://cli-assets.heroku.com/branches/stable/heroku-osx.pkg" target="_blank" rel="noopener">Mac os</a></li><li><a href="https://cli-assets.heroku.com/branches/stable/heroku-windows-amd64.exe" target="_blank" rel="noopener">Windows 64</a></li></ul><p>å…¶ä½™çš„è®¿é—® <a href="https://devcenter.heroku.com/articles/getting-started-with-nodejs#set-up" target="_blank" rel="noopener">ä¸‹è½½åœ°å€</a></p><h2 id="åˆ›å»ºä¸€ä¸ª-Express-åº”ç”¨"><a href="#åˆ›å»ºä¸€ä¸ª-Express-åº”ç”¨" class="headerlink" title="åˆ›å»ºä¸€ä¸ª Express åº”ç”¨"></a>åˆ›å»ºä¸€ä¸ª Express åº”ç”¨</h2><p>ä½¿ç”¨<code>Yeoman</code>å’Œ<code>generator-express</code>æ¥å¿«é€Ÿåˆ›å»ºä¸€ä¸ª Express åº”ç”¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// å®‰è£… yeoman</span><br><span class="line">npm install -g yo</span><br><span class="line"></span><br><span class="line">// å®‰è£… generator-express</span><br><span class="line">npm install -g generator-express </span><br><span class="line"></span><br><span class="line">// æ–°å»ºé¡¹ç›®æ–‡ä»¶å¤¹</span><br><span class="line">mkdir heroku-express</span><br><span class="line">cd heroku-express</span><br><span class="line">git init</span><br><span class="line"></span><br><span class="line">// åˆ›å»ºé¡¹ç›®</span><br><span class="line">yo express </span><br><span class="line"></span><br><span class="line">// æäº¤ä»£ç </span><br><span class="line">git add .</span><br><span class="line">git commit -m "Init project"</span><br></pre></td></tr></table></figure><a id="more"></a><p>æµ‹è¯•ä¸€ä¸‹åˆšåˆšåˆ›å»ºçš„é¡¹ç›®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// å¯åŠ¨ Express</span><br><span class="line">npm start</span><br></pre></td></tr></table></figure><p>è®¿é—® <a href="http://localhost:3000/" target="_blank" rel="noopener">http://localhost:3000/</a> æŸ¥çœ‹ Express æ˜¯å¦æˆåŠŸå¯åŠ¨</p><h2 id="åœ¨-Heroku-ä¸Šåˆ›å»ºé¡¹ç›®"><a href="#åœ¨-Heroku-ä¸Šåˆ›å»ºé¡¹ç›®" class="headerlink" title="åœ¨ Heroku ä¸Šåˆ›å»ºé¡¹ç›®"></a>åœ¨ Heroku ä¸Šåˆ›å»ºé¡¹ç›®</h2><p>è¿›å…¥æˆ‘ä»¬åˆšåˆšæ–°å»ºçš„é¡¹ç›®, è¿è¡Œ <code>create</code> æŒ‡ä»¤åˆ›å»ºé¡¹ç›®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">heroku create [your_app_name]</span><br></pre></td></tr></table></figure><p>è¿è¡Œå®Œæˆå, Heroku ä¼šåœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸Šæ–°å»ºä¸€ä¸ª<code>git</code> çš„è¿œç¨‹åˆ†æ”¯, åŒæ—¶ä¼šä¸ºé¡¹ç›®åˆ›å»ºä¸€ä¸ªåŸŸåä¾›æˆ‘ä»¬è®¿é—®</p><p>è¿™é‡Œæ˜¯æˆ‘çš„è¿è¡Œç»“æœ<img src="./heroku-1.png" alt="è¿è¡Œç»“æœ"></p><h2 id="åœ¨-Heroku-ä¸Šéƒ¨ç½²åº”ç”¨"><a href="#åœ¨-Heroku-ä¸Šéƒ¨ç½²åº”ç”¨" class="headerlink" title="åœ¨ Heroku ä¸Šéƒ¨ç½²åº”ç”¨"></a>åœ¨ Heroku ä¸Šéƒ¨ç½²åº”ç”¨</h2><p>éƒ¨ç½²ä¹‹å‰æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªç±»ä¼¼å¯åŠ¨è„šæœ¬çš„æ–‡ä»¶ <code>Procfile</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// Profile </span><br><span class="line"></span><br><span class="line">web: node ./bin/www</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–‡ä»¶å‘Šè¯‰ <code>Heroku</code>éœ€è¦åˆ›å»ºä¸€ä¸ªweb å®¹å™¨, åŒæ—¶æ‰§è¡Œ <code>node ./bin/www</code> æ¥å¯åŠ¨ç¨‹åº</p><blockquote><p>æˆ‘ä»¬çš„é¡¹ç›®åªéœ€è¦è¿™æ ·å°±å¯ä»¥äº†, æ›´å¤šçš„è¯¦ç»†ä¿¡æ¯åœ¨è¿™é‡Œ <a href="https://devcenter.heroku.com/articles/procfile" target="_blank" rel="noopener">Process Types and the Procfile</a></p></blockquote><p>ç„¶åå°†åˆšåˆšçš„æ”¹åŠ¨æäº¤, åŒæ—¶æ¨é€çš„ Heroku</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git ci -m &quot;Add procfile&quot;</span><br><span class="line"></span><br><span class="line">git push heroku master</span><br></pre></td></tr></table></figure><p><strong>å½“ä½ å°†ä»£ç æ¨é€åˆ° Heroku çš„ master åˆ†æ”¯ä¸Šæ—¶, å®ƒå°±ä¼šæ ¹æ®<code>package.json</code>ä¸­çš„å†…å®¹å®‰è£…æ‰€éœ€è¦çš„ä¾èµ–, ç„¶åæ‰§è¡Œ <code>Procfile</code> ä¸­çš„å†…å®¹, è¿™å°±å®Œæˆçš„ç¨‹åºçš„éƒ¨ç½²</strong></p><p>è¿™é‡Œæ˜¯æˆ‘çš„éƒ¨ç½²ç»“æœ</p><p><img src="./heroku-2.png" alt></p><p>ç„¶åä½ åœ¨è®¿é—®åˆšåˆš Heroku ç»™çš„ç½‘å€, å°±å¯ä»¥çœ‹åˆ°ç¨‹åºå·²ç»è¿è¡Œ</p><h2 id="å®šä¹‰ç¨‹åºä¾èµ–å’Œè¿è¡Œå˜é‡"><a href="#å®šä¹‰ç¨‹åºä¾èµ–å’Œè¿è¡Œå˜é‡" class="headerlink" title="å®šä¹‰ç¨‹åºä¾èµ–å’Œè¿è¡Œå˜é‡"></a>å®šä¹‰ç¨‹åºä¾èµ–å’Œè¿è¡Œå˜é‡</h2><ol><li><p>é€šè¿‡<code>package.json</code>å®šä¹‰ç¨‹åºä¾èµ–</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"heroku-express"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"0.0.1"</span>,</span><br><span class="line">  ...</span><br><span class="line">  "dependencies": &#123;</span><br><span class="line">    "express": "^4.13.3",</span><br><span class="line">    "serve-favicon": "^2.3.0",</span><br><span class="line">    "morgan": "^1.6.1",</span><br><span class="line">    "cookie-parser": "^1.3.3",</span><br><span class="line">    "body-parser": "^1.13.3",</span><br><span class="line">    "swig": "^1.4.2"</span><br><span class="line">  &#125;,</span><br><span class="line">  ... </span><br><span class="line">  "engines": &#123;</span><br><span class="line">    "node": "^8.3.0"</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>dependencies å­—æ®µå®šä¹‰ç¨‹åºä¾èµ–</p><p>engines å­—æ®µå®šä¹‰éœ€è¦çš„ Node ç‰ˆæœ¬</p><p>â€‹</p></li><li><p>å®šä¹‰è¿è¡Œå˜é‡</p><ol><li><p>æœ¬åœ°è¿è¡Œå˜é‡</p><p>æœ¬åœ°ä½¿ç”¨ <code>.env</code> æ–‡ä»¶æ¥å®šä¹‰å˜é‡, æ ¼å¼å¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NAME=VALUE</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>heroku local web</code> æ¥å¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨, åŒæ—¶ä¼šå°†å˜é‡ä¿¡æ¯æ³¨å…¥åˆ°<code>process.env</code>ä¸­</p></li><li><p>å®¹å™¨è¿è¡Œå˜é‡</p><p>å®¹å™¨çš„è¿è¡Œå˜é‡éœ€è¦é€šè¿‡ <code>heroku config:set NAME=VALUE</code>æ¥è®¾ç½®</p><p>ä½¿ç”¨ <code>heroku config</code>æ¥æŸ¥çœ‹å˜é‡</p></li></ol><blockquote><p>è¯¦ç»†ä¿¡æ¯ <a href="https://devcenter.heroku.com/articles/config-vars" target="_blank" rel="noopener">Configuration and Config Vars</a></p></blockquote><p>â€‹</p></li></ol><h2 id="ä¸å®¹å™¨è¿›è¡Œè¿œç¨‹äº¤äº’"><a href="#ä¸å®¹å™¨è¿›è¡Œè¿œç¨‹äº¤äº’" class="headerlink" title="ä¸å®¹å™¨è¿›è¡Œè¿œç¨‹äº¤äº’"></a>ä¸å®¹å™¨è¿›è¡Œè¿œç¨‹äº¤äº’</h2><ol><li><p>æŸ¥çœ‹è¿è¡Œæ—¥å¿—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">heroku logs --tail</span><br></pre></td></tr></table></figure></li><li><p>åœ¨å®¹å™¨ä¸­è¿è¡Œå‘½ä»¤ <code>heroku run command</code></p><ol><li><code>heroku run node</code> è¿›å…¥Node çš„ REPL</li><li><code>heroku run bash</code> è¿›å»å®¹å™¨è¿è¡Œbash</li></ol></li></ol><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p>Heroku çš„å…è´¹ç‰ˆæœ¬æ¯ä¸ªæœˆæä¾›äº† 550 å°æ—¶çš„ä½¿ç”¨æ—¶é—´, å½“æˆ‘ä»¬çš„ç¨‹åºåŠä¸ªå°æ—¶å†…æ²¡æœ‰è®¿é—®æµé‡æ—¶å°±ä¼šè¢«ä¼‘çœ æ‰, åœ¨ä¸‹æ¬¡è¢«è®¿é—®çš„æ—¶å€™æ¿€æ´»</p><p>æ‰€ä»¥é•¿æ—¶é—´æ²¡æœ‰è®¿é—®çš„åº”ç”¨, åœ¨ç¬¬ä¸€æ¬¡è®¿é—®ä¼šå¾ˆæ…¢, ä¸è¿‡ä¹Ÿå°±å¤Ÿç”¨äº†</p><p>æˆ‘ä¹Ÿå°†è¿™ç¯‡æ–‡ç« éƒ¨ç½²åœ¨è¿™ä¸ªåº”ç”¨ä¸Š, <a href="https://lleohao-heroku-express.herokuapp.com/article" target="_blank" rel="noopener">https://lleohao-heroku-express.herokuapp.com/article</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;å°è¯•ä½¿ç”¨äº†ä¸‹Heroku, åœ¨ä¸Šé¢éƒ¨ç½² Node ç¨‹åºè¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„, ä¸»è¦ä¼˜åŠ¿åœ¨äºå®ƒçš„ç½‘ç»œå¯ä»¥è®¿é—®åˆ°å¤–ç½‘, å…·ä½“åº”ç”¨éƒ½æ‡‚å¾—&lt;/p&gt;
&lt;p&gt;è¿™é‡Œè®°å½•ä¸‹å¦‚ä½•åœ¨ Heroku ä¸Šåˆ›å»ºã€å¼€å‘ã€éƒ¨ç½² Node &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://devcenter.heroku.com/articles/getting-started-with-nodejs#introduction&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å®˜æ–¹çš„æ–‡æ¡£åœ¨è¿™é‡Œ&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;&lt;h2 id=&quot;å®‰è£…-Heroku-cli&quot;&gt;&lt;a href=&quot;#å®‰è£…-Heroku-cli&quot; class=&quot;headerlink&quot; title=&quot;å®‰è£… Heroku cli&quot;&gt;&lt;/a&gt;å®‰è£… Heroku cli&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://cli-assets.heroku.com/branches/stable/heroku-osx.pkg&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Mac os&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cli-assets.heroku.com/branches/stable/heroku-windows-amd64.exe&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Windows 64&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;å…¶ä½™çš„è®¿é—® &lt;a href=&quot;https://devcenter.heroku.com/articles/getting-started-with-nodejs#set-up&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;&lt;h2 id=&quot;åˆ›å»ºä¸€ä¸ª-Express-åº”ç”¨&quot;&gt;&lt;a href=&quot;#åˆ›å»ºä¸€ä¸ª-Express-åº”ç”¨&quot; class=&quot;headerlink&quot; title=&quot;åˆ›å»ºä¸€ä¸ª Express åº”ç”¨&quot;&gt;&lt;/a&gt;åˆ›å»ºä¸€ä¸ª Express åº”ç”¨&lt;/h2&gt;&lt;p&gt;ä½¿ç”¨&lt;code&gt;Yeoman&lt;/code&gt;å’Œ&lt;code&gt;generator-express&lt;/code&gt;æ¥å¿«é€Ÿåˆ›å»ºä¸€ä¸ª Express åº”ç”¨&lt;/p&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;// å®‰è£… yeoman&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;npm install -g yo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// å®‰è£… generator-express&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;npm install -g generator-express &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// æ–°å»ºé¡¹ç›®æ–‡ä»¶å¤¹&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mkdir heroku-express&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cd heroku-express&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git init&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// åˆ›å»ºé¡¹ç›®&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;yo express &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// æäº¤ä»£ç &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git add .&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git commit -m &quot;Init project&quot;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>å¯¹å¤æ‚ä¸šåŠ¡ç»„ä»¶åœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­è¢«è°ƒç”¨çš„åæ€</title>
    <link href="https://lleohao.github.io/2017/10/12/%E5%AF%B9%E5%A4%8D%E6%9D%82%E4%B8%9A%E5%8A%A1%E7%BB%84%E4%BB%B6%E5%9C%A8%E5%AE%9E%E9%99%85%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8B%E4%B8%AD%E8%A2%AB%E8%B0%83%E7%94%A8%E7%9A%84%E5%8F%8D%E6%80%9D/"/>
    <id>https://lleohao.github.io/2017/10/12/å¯¹å¤æ‚ä¸šåŠ¡ç»„ä»¶åœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­è¢«è°ƒç”¨çš„åæ€/</id>
    <published>2017-10-12T12:32:22.000Z</published>
    <updated>2020-11-24T06:07:16.916Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å†™è¿™ç¯‡æ–‡ç« çš„åˆè¡·æ˜¯ä¸ºäº†è®°å½•æˆ‘åœ¨ä¿®å¤é¡¹ç›®ä¸­ä¸€ä¸ªå¤æ‚ä¸šåŠ¡ç»„ä»¶ä¸­çš„bugè€Œå¼•èµ·å…¶ä»–ä¾èµ–è¿™ä¸ªç»„ä»¶çš„åŠŸèƒ½æ— æ³•ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹ä½¿ç”¨ã€ç»´æŠ¤å¤æ‚ä¸šåŠ¡ç»„ä»¶çš„ä¸€äº›æ€è€ƒ</p></blockquote><h2 id="Bugå‘ç”ŸåŸå› "><a href="#Bugå‘ç”ŸåŸå› " class="headerlink" title="Bugå‘ç”ŸåŸå› "></a>Bugå‘ç”ŸåŸå› </h2><p>æˆ‘æ‰€åœ¨çš„é¡¹ç›®ç»„ä¸­, æœ‰ä¸€ä¸ªç±»ä¼¼æ ‘çŠ¶æ–‡ä»¶ç®¡ç†çš„éœ€æ±‚</p><p>å¯¹äºè¿™æ ·çš„éœ€æ±‚ï¼Œå½“æ—¶æˆ‘è®¾è®¡ä¸€ä¸ªåŸºç¡€çš„UIç»„ä»¶<code>treeListView</code>ç”¨æ¥å®ç°åŸºç¡€çš„æ ‘çŠ¶UIï¼Œ åŒæ—¶åœ¨å…¶åŸºç¡€ä¸Šå®ç°äº†<code>explorer</code>ä¸šåŠ¡ç»„ä»¶æ¥å®ç°å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚</p><p>ç”±äºæ˜¯æ ‘çŠ¶çš„è§†å›¾ï¼Œæ‰€ä»¥åœ¨å½“æ—¶è®¾è®¡æ•°æ®ç»“æ„æ—¶ä¹Ÿé‡‡ç”¨æ ‘ä½œä¸ºæ•°æ®ç»“æ„ã€‚ä¸ºäº†èƒ½å¤Ÿæ–¹ä¾¿çš„æŸ¥æ‰¾æ ‘ä¸­çš„æ•°æ®ï¼Œæˆ‘æŒ‰ç…§ç³»ç»Ÿçš„æ–‡ä»¶ç®¡ç†ç»™æ‰€æœ‰çš„æ•°æ®æ·»åŠ äº†ä¸€ä¸ª<code>path</code>å±æ€§ã€‚</p><p>ä½†æ˜¯åœ¨å®ç°çš„æ—¶å€™æ²¡æœ‰è€ƒè™‘åˆ°åŒçº§ç›®å½•ä¸‹é¢å¯èƒ½åŒæ—¶å­˜åœ¨åŒåçš„æ–‡ä»¶å¤¹å’Œæ–‡ä»¶è¿™ç§æƒ…å†µï¼Œå‡è®¾æ–‡ä»¶å¤¹<code>folder</code>ä¸‹é¢åŒæ—¶å­˜åœ¨åä¸º<code>file</code>çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼Œè¿™ä¸ªæ—¶å€™ä¼šé€ æˆå®ƒä»¬çš„è·¯å¾„ç›¸åŒï¼Œåœ¨æŸ¥æ‰¾çš„æ—¶å€™æ— æ³•åŒºåˆ†è¿™ä¸¤ä¸ªæ•°æ®ã€‚ä¿®å¤çš„æ–¹æ³•æ˜¯åœ¨æ–‡ä»¶å¤¹çš„è·¯å¾„åé¢å¢åŠ <code>/</code>ã€‚</p><a id="more"></a><p>è¿™æ ·ä¿®å¤åï¼Œç”±äºåœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­æœ‰è®¸å¤šçš„åœ°æ–¹ç›´æ¥ä½¿ç”¨<code>path</code>æ¥æ¥åšåˆ¤è¯»ï¼Œä¾‹å¦‚æœ‰çš„åœ°æ–¹ç›´æ¥åˆ†å‰²<code>path</code>æ¥è·å–å½“å‰æ•°æ®çš„åç§°æˆ–è€…å…¶çˆ¶å…ƒç´ çš„åç§°ï¼ˆè™½ç„¶æœ‰æ›´å¥½çš„æ–¹å¼è·å–è¿™äº›æ•°æ®ï¼Œä½†æ˜¯å¼€å‘è¿‡ç¨‹ä¸­å¯èƒ½ä¸ºäº†çœäº‹ç›´æ¥è¿™æ ·è·å–ï¼‰ï¼Œæˆ–è€…åœ¨æ–°å»ºæ–‡ä»¶ã€æ–‡ä»¶å¤¹æ—¶è‡ªå·±æ‰‹åŠ¨çš„æ‹¼å†™<code>path</code>ã€‚</p><p>å½“æˆ‘æŒ‰ç…§ä¸Šé¢çš„æ–¹å¼ä¿®å¤bugæ—¶ï¼Œå°±å¿…é¡»åŒæ—¶ä¿®æ”¹è¿™ä¸ªä¾èµ–<code>path</code>çš„å‡½æ•°æ“ä½œï¼Œå½“é¡¹ç›®ä¸­çš„ä»£ç å¤ªå¤šæ—¶å°±å¯èƒ½å‡ºç°é—æ¼çš„æƒ…å†µï¼Œç»™ä»£ç çš„ç»´æŠ¤å¸¦æ¥å¾ˆå¤§çš„å›°æ‰°ã€‚</p><h2 id="ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¹ˆå¤šçš„é—®é¢˜"><a href="#ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¹ˆå¤šçš„é—®é¢˜" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¹ˆå¤šçš„é—®é¢˜?"></a>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¹ˆå¤šçš„é—®é¢˜?</h2><p>é—®é¢˜å‡ºç°äº†ä¹‹åå°±åº”è¯¥å»åæ€ä¸ºä»€ä¹ˆé€ æˆç°åœ¨è¿™æ ·çš„å±€é¢ã€‚è¯šç„¶æœ‰ä¸€éƒ¨åˆ†çš„åŸå› æ˜¯æˆ‘ä»¬åœ¨å¼€å‘è¿‡ç¨‹ä¸­ç»å¸¸ä¼šå›¾æ–¹ä¾¿è€Œéšæ„çš„ä½¿ç”¨æ•°æ®ï¼Œä½†æ˜¯æ ¹æœ¬çš„åŸå› æ˜¯åœ¨å¯¹ä¸€ä¸ªå¤æ‚çš„ä¸šåŠ¡ç»„ä»¶è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œæ²¡æœ‰ä¸€ä¸ªæ–¹ä¾¿ã€æœ‰æ•ˆçš„æ“ä½œé€ æˆçš„ã€‚æ¢å¥è¯è¯´å°±æ˜¯å¯¹äº<strong>ç»„ä»¶ä¾èµ–çš„æ•°æ®æ²¡æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„æ“ä½œ</strong>é€ æˆçš„ã€‚</p><p>ç»„ä»¶çš„æ­£ç¡®ä¾èµ–äºæ•°æ®çš„æ­£ç¡®ï¼Œè€Œåœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ä¸åŒçš„å¼€å‘äººå‘˜æœ‰ç€ä¸åŒçš„é£æ ¼çš„æ•°æ®å¤„ç†æ–¹å¼ã€‚ ä¸€æ—¦æ•°æ®ç»“æ„å‡ºç°äº†é”™è¯¯æˆ–è€…å‘ç”Ÿäº†ä¿®æ”¹ï¼Œå°±ä¼šå¯¼è‡´ç»„ä»¶å‡ºç°æ„æƒ³ä¸åˆ°é—®é¢˜ã€‚</p><h2 id="å¦‚ä½•è§£å†³è¿™æ ·çš„é—®é¢˜"><a href="#å¦‚ä½•è§£å†³è¿™æ ·çš„é—®é¢˜" class="headerlink" title="å¦‚ä½•è§£å†³è¿™æ ·çš„é—®é¢˜?"></a>å¦‚ä½•è§£å†³è¿™æ ·çš„é—®é¢˜?</h2><p>å¯¹äºä¸šåŠ¡ç»„ä»¶, æˆ‘ä»¬æ˜¯å¯ä»¥æ€»ç»“å‡ºå¯¹è¿™ä¸ªä¸šåŠ¡ç»„ä»¶çš„è°ƒç”¨çš„ä½¿ç”¨æƒ…å†µï¼Œä¾‹å¦‚æœ¬æ–‡ä¸­çš„<code>explorer</code>ç»„ä»¶ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µ:</p><ol><li>æ–°å»ºæ–‡ä»¶å¤¹ã€æ–‡ä»¶</li><li>åˆ é™¤æ–‡ä»¶å¤¹ã€æ–‡ä»¶</li><li>ä¿®æ”¹æ–‡ä»¶å¤¹ã€æ–‡ä»¶</li><li>æ ¹æ®è·¯å¾„æŸ¥æ‰¾æ–‡ä»¶å¤¹ã€æ–‡ä»¶</li><li>æ ¹æ®è·¯å¾„æŸ¥æ‰¾çˆ¶æ–‡ä»¶å¤¹</li></ol><p>å¯¹äºè¿™äº›æ“ä½œï¼Œåœ¨ç»„ä»¶çš„ç¼–å†™è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯ä»¥åŒæ—¶ç¼–å†™å¯¹åº”çš„è¾…åŠ©å‡½æ•°ï¼Œ</p><p>å¦‚<code>explorer</code>ç»„ä»¶æˆ‘å°±ç¼–å†™ä¸‹é¢çš„è¾…åŠ©å‡½æ•°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  <span class="comment">// ä¿®æ”¹å±æ€§æ“ä½œ</span></span><br><span class="line">  modify: modify,</span><br><span class="line">  <span class="comment">// é‡å‘½åæ“ä½œ</span></span><br><span class="line">  rename: rename,</span><br><span class="line">  <span class="comment">// æ–°å»ºæ“ä½œ</span></span><br><span class="line">  create: create,</span><br><span class="line">  <span class="comment">// å¤åˆ¶æ“ä½œ</span></span><br><span class="line">  copy: copy,</span><br><span class="line">  <span class="comment">// ç§»åŠ¨æ“ä½œ</span></span><br><span class="line">  move: move,</span><br><span class="line">  <span class="comment">// åˆ é™¤æ“ä½œ</span></span><br><span class="line">  remove: remove,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æœç´¢æ ‘ä¸­ç¬¦åˆè¦æ±‚çš„æ•°æ®</span></span><br><span class="line">  searchTree: searchTree,</span><br><span class="line">  <span class="comment">// æ ¹æ®è·¯å¾„è¿”å›åœ¨æ ‘ç§çš„ç´¢å¼•</span></span><br><span class="line">  searchByPath: searchByPath,</span><br><span class="line">  <span class="comment">// æ ¹æ®è·¯å¾„è·å–æ•°æ®</span></span><br><span class="line">  getDataByPath: getDataByPath,</span><br><span class="line">  <span class="comment">// æ ¹æ®è·¯å¾„è·å–çˆ¶ç›®å½•çš„æ•°æ®</span></span><br><span class="line">  getParentDataByPath: getParentDataByPath,</span><br><span class="line">  <span class="comment">// æ ¹æ®è·¯å¾„è·å–çˆ¶ç›®å½•è·¯å¾„</span></span><br><span class="line">  getParentPath: getParentPath</span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–æ•°æ®ä¸­çš„path</span></span><br><span class="line">  addSourcePath: addSourcePath,</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// åˆ¤æ–­æ˜¯å¦å­˜åœ¨åŒåæ•°æ®(ç”¨äºæ–°å»ºæ—¶åŒååˆ¤æ–­)</span></span><br><span class="line">  hasSameName: hasSameName</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å¯¹äºè°ƒç”¨è€…æ¥è¯´ï¼Œåªè¦ä½¿ç”¨ç»„ä»¶æä¾›çš„è¾…åŠ©å‡½æ•°å°±å¯ä»¥æ–¹ä¾¿çš„ä½¿ç”¨ç»„ä»¶ï¼›å¯¹äºç»„ä»¶çš„ç»´æŠ¤è€…æ¥è¯´ï¼Œåªè¦ä¿è¯è¾…åŠ©å‡½æ•°çš„æ­£ç¡®æ€§ï¼Œå°±å¯ä»¥ä¿è¯ç»„ä»¶åœ¨è¢«è°ƒç”¨çš„è¿‡ç¨‹çš„æ­£ç¡®ï¼Œæ–¹ä¾¿ç»„ä»¶çš„ç»´æŠ¤ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œå°±æ˜¯åœ¨ç¼–å†™è¿™æ ·å¤æ‚çš„ä¸šåŠ¡ç»„ä»¶ï¼Œæˆ‘ä»¬åº”è¯¥åŒæ—¶ç¼–å†™ç›¸å…³çš„è¾…åŠ©å‡½æ•°æ¥æ–¹ä¾¿ç»„ä»¶çš„è°ƒç”¨è€…æ¥ä½¿ç”¨ã€‚è€Œæˆ‘ä»¬åœ¨å¼€å‘ä¸­ä¹Ÿåº”å½“é¿å…å†™å‡ºä¸Šæ–‡ä¸­é‚£æ ·å¯¹æ•°æ®ç›´æ¥è¿›è¡Œæ“ä½œçš„ä»£ç ï¼Œè¿™ä¼šå¯¼è‡´ä¸šåŠ¡çš„æ­£ç¡®ä¾èµ–äºç»„ä»¶çš„å†…éƒ¨æ•°æ®ç›¸è€¦åˆï¼Œä½¿ç»„ä»¶éš¾ä»¥ç»´æŠ¤ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;å†™è¿™ç¯‡æ–‡ç« çš„åˆè¡·æ˜¯ä¸ºäº†è®°å½•æˆ‘åœ¨ä¿®å¤é¡¹ç›®ä¸­ä¸€ä¸ªå¤æ‚ä¸šåŠ¡ç»„ä»¶ä¸­çš„bugè€Œå¼•èµ·å…¶ä»–ä¾èµ–è¿™ä¸ªç»„ä»¶çš„åŠŸèƒ½æ— æ³•ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹ä½¿ç”¨ã€ç»´æŠ¤å¤æ‚ä¸šåŠ¡ç»„ä»¶çš„ä¸€äº›æ€è€ƒ&lt;/p&gt;
&lt;/blockquote&gt;&lt;h2 id=&quot;Bugå‘ç”ŸåŸå› &quot;&gt;&lt;a href=&quot;#Bugå‘ç”ŸåŸå› &quot; class=&quot;headerlink&quot; title=&quot;Bugå‘ç”ŸåŸå› &quot;&gt;&lt;/a&gt;Bugå‘ç”ŸåŸå› &lt;/h2&gt;&lt;p&gt;æˆ‘æ‰€åœ¨çš„é¡¹ç›®ç»„ä¸­, æœ‰ä¸€ä¸ªç±»ä¼¼æ ‘çŠ¶æ–‡ä»¶ç®¡ç†çš„éœ€æ±‚&lt;/p&gt;&lt;p&gt;å¯¹äºè¿™æ ·çš„éœ€æ±‚ï¼Œå½“æ—¶æˆ‘è®¾è®¡ä¸€ä¸ªåŸºç¡€çš„UIç»„ä»¶&lt;code&gt;treeListView&lt;/code&gt;ç”¨æ¥å®ç°åŸºç¡€çš„æ ‘çŠ¶UIï¼Œ åŒæ—¶åœ¨å…¶åŸºç¡€ä¸Šå®ç°äº†&lt;code&gt;explorer&lt;/code&gt;ä¸šåŠ¡ç»„ä»¶æ¥å®ç°å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚&lt;/p&gt;&lt;p&gt;ç”±äºæ˜¯æ ‘çŠ¶çš„è§†å›¾ï¼Œæ‰€ä»¥åœ¨å½“æ—¶è®¾è®¡æ•°æ®ç»“æ„æ—¶ä¹Ÿé‡‡ç”¨æ ‘ä½œä¸ºæ•°æ®ç»“æ„ã€‚ä¸ºäº†èƒ½å¤Ÿæ–¹ä¾¿çš„æŸ¥æ‰¾æ ‘ä¸­çš„æ•°æ®ï¼Œæˆ‘æŒ‰ç…§ç³»ç»Ÿçš„æ–‡ä»¶ç®¡ç†ç»™æ‰€æœ‰çš„æ•°æ®æ·»åŠ äº†ä¸€ä¸ª&lt;code&gt;path&lt;/code&gt;å±æ€§ã€‚&lt;/p&gt;&lt;p&gt;ä½†æ˜¯åœ¨å®ç°çš„æ—¶å€™æ²¡æœ‰è€ƒè™‘åˆ°åŒçº§ç›®å½•ä¸‹é¢å¯èƒ½åŒæ—¶å­˜åœ¨åŒåçš„æ–‡ä»¶å¤¹å’Œæ–‡ä»¶è¿™ç§æƒ…å†µï¼Œå‡è®¾æ–‡ä»¶å¤¹&lt;code&gt;folder&lt;/code&gt;ä¸‹é¢åŒæ—¶å­˜åœ¨åä¸º&lt;code&gt;file&lt;/code&gt;çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼Œè¿™ä¸ªæ—¶å€™ä¼šé€ æˆå®ƒä»¬çš„è·¯å¾„ç›¸åŒï¼Œåœ¨æŸ¥æ‰¾çš„æ—¶å€™æ— æ³•åŒºåˆ†è¿™ä¸¤ä¸ªæ•°æ®ã€‚ä¿®å¤çš„æ–¹æ³•æ˜¯åœ¨æ–‡ä»¶å¤¹çš„è·¯å¾„åé¢å¢åŠ &lt;code&gt;/&lt;/code&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="å‰ç«¯" scheme="https://lleohao.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="JavaScript" scheme="https://lleohao.github.io/tags/JavaScript/"/>
    
      <category term="ç»„ä»¶åŒ–å¼€å‘" scheme="https://lleohao.github.io/tags/%E7%BB%84%E4%BB%B6%E5%8C%96%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•æ­å»ºElectronå¼€å‘ç¯å¢ƒ</title>
    <link href="https://lleohao.github.io/2017/09/02/%E5%A6%82%E4%BD%95%E6%90%AD%E5%BB%BAElectron%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"/>
    <id>https://lleohao.github.io/2017/09/02/å¦‚ä½•æ­å»ºElectronå¼€å‘ç¯å¢ƒ/</id>
    <published>2017-09-02T02:29:50.000Z</published>
    <updated>2020-11-24T06:07:16.916Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>è¿™ä¸ªé¡¹ç›®ç»“æ„æ˜¯æˆ‘åœ¨ç¼–å†™  <a href="https://github.com/lleohao/qiniu-upload" target="_blank" rel="noopener">åŸºäºElectron å’Œ Angular çš„ä¸ƒç‰›æ–‡ä»¶ä¸Šä¼ App</a>  æ€»ç»“å‡ºæ¥çš„</p><p>æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•ä»é›¶å¼€å§‹æ­å»ºé«˜æ•ˆçš„Electronå¼€å‘ç¯å¢ƒ, ä¸»è¦å†…å®¹å¦‚ä¸‹ï¼š</p><ol><li>é€šè¿‡åˆç†çš„ç›®å½•åˆ’åˆ†æ¥ç»„ç»‡ä»£ç </li><li>ä½¿ç”¨<code>npm script</code>ç®€åŒ–å¼€å‘</li><li>å¦‚ä½•åœ¨æ¸²æŸ“è¿›ç¨‹å¼€å‘æ—¶ä½¿ç”¨çƒ­æ›´æ–°</li><li>å¦‚ä½•åœ¨ä¸»è¿›ç¨‹å¼€å‘æ—¶ä½¿ç”¨è‡ªåŠ¨é‡å¯</li><li>å¦‚ä½•åœ¨ä¸»è¿›ç¨‹å¼€å‘æ—¶ä½¿ç”¨<code>Typescript</code></li><li>å¦‚ä½•æ‰“åŒ…å’Œå‘å¸ƒè½¯ä»¶</li></ol><p>ç¤ºä¾‹é¡¹ç›®åœ°å€ <a href="https://github.com/lleohao/electron-base" target="_blank" rel="noopener">https://github.com/lleohao/electron-base</a></p></blockquote><h2 id="ç›®å½•ç»“æ„åˆ’åˆ†"><a href="#ç›®å½•ç»“æ„åˆ’åˆ†" class="headerlink" title="ç›®å½•ç»“æ„åˆ’åˆ†"></a>ç›®å½•ç»“æ„åˆ’åˆ†</h2><h3 id="åˆå§‹åŒ–ç›®å½•"><a href="#åˆå§‹åŒ–ç›®å½•" class="headerlink" title="åˆå§‹åŒ–ç›®å½•"></a>åˆå§‹åŒ–ç›®å½•</h3><p>é¦–å…ˆæŒ‰ç…§å¸¸è§„çš„æ–¹æ³•æ–°å»ºä¸€ä¸ªé¡¹ç›®æ–‡ä»¶å¤¹(è¿™é‡Œæˆ‘çš„ç¤ºä¾‹æ–‡ä»¶å¤¹å«åš<code>electron-base</code>ï¼Œ ç„¶åä½¿ç”¨<code>npm init</code>åˆå§‹åŒ–ç›®å½•ã€‚</p><a id="more"></a><p>ç›®å‰æˆ‘ä»¬çš„å¼€å‘ç›®å½•å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">electorn-base</span><br><span class="line">â”œâ”€â”€ .gitignore - gitå¿½ç•¥æ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ LICENSE - å¼€æºåè®®</span><br><span class="line">â”œâ”€â”€ README.md - æ–‡æ¡£</span><br><span class="line">â””â”€â”€ package.json - npm package</span><br></pre></td></tr></table></figure><h3 id="ç›®å½•åˆ’åˆ†"><a href="#ç›®å½•åˆ’åˆ†" class="headerlink" title="ç›®å½•åˆ’åˆ†"></a>ç›®å½•åˆ’åˆ†</h3><p>Electron çš„å¼€å‘ä¸»è¦åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†,  å…¶ä¸­ä¸»è¿›ç¨‹(Main Process)ä¸»è¦è´Ÿè´£æ‰“å¼€é¡µé¢å’Œè°ƒç”¨ç³»ç»Ÿåº•å±‚çš„èµ„æºç­‰, æ¸²æŸ“è¿›ç¨‹(Renderer Process)åˆ™æ˜¯ä¸€ä¸ªæ™®é€šçš„ç½‘é¡µçª—å£.</p><p>ä¸¤ä¸ªè¿›ç¨‹çš„å¼€å‘æœ‰ç€ä¸åŒçš„å¼€å‘æ–¹å¼, ä¸»è¿›ç¨‹æ›´åƒæ˜¯ä¼ ç»Ÿ<code>Node</code>çš„å¼€å‘, è€Œæ¸²æŸ“è¿›ç¨‹åˆ™æ˜¯æ™®é€šçš„å‰ç«¯å¼€å‘. åŒæ—¶å®ƒä»¬ä¹‹é—´åˆæœ‰ç€å¯ä»¥å…±ç”¨çš„éƒ¨åˆ†(å¦‚è¾…åŠ©å‡½æ•°ã€æ•°æ®æ¨¡å‹ç­‰), å› æ­¤å¯ä»¥æŒ‰ç…§ä¸‹é¢çš„æ–¹å¼åˆ’åˆ†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">electorn-base</span><br><span class="line">â”œâ”€â”€ ... - çœç•¥</span><br><span class="line">â””â”€â”€ src - ä»£ç æºæ–‡ä»¶</span><br><span class="line">    â”œâ”€â”€ main - ä¸»çº¿ç¨‹ä»£ç </span><br><span class="line">    â”œâ”€â”€ renderer - æ¸²æŸ“çº¿ç¨‹</span><br><span class="line">    â””â”€â”€ shared - å…¬ç”¨ä»£ç </span><br></pre></td></tr></table></figure><h3 id="Electron-quick-start"><a href="#Electron-quick-start" class="headerlink" title="Electron quick start"></a>Electron quick start</h3><p>æ¥ä¸‹æ¥è¿è¡Œ<code>npm install electron -D</code>å®‰è£…Electronï¼ŒåŒæ—¶åœ¨<code>package.json</code>æ·»åŠ <code>main</code>å­—æ®µï¼Œ è¿™ä»£è¡¨æ•´ä¸ªé¡¹ç›®çš„å…¥å£æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆè®¾ç½®ä¸º<code>src/main/main.js</code>.</p><p>é¡ºä¾¿æ·»åŠ ä¸Šä¸¤ä¸ªæ–‡ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"># src/main.js</span><br><span class="line"><span class="keyword">const</span> &#123; app, BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">'electron'</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> win</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createWindow</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    win = <span class="keyword">new</span> BrowserWindow(&#123; <span class="attr">width</span>: <span class="number">800</span>, <span class="attr">height</span>: <span class="number">600</span> &#125;)</span><br><span class="line"></span><br><span class="line">    win.loadURL(url.format(&#123;</span><br><span class="line">        pathname: path.join(__dirname, <span class="string">'../renderer/index.html'</span>),</span><br><span class="line">        protocol: <span class="string">'file:'</span>,</span><br><span class="line">        slashes: <span class="literal">true</span></span><br><span class="line">    &#125;))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Open the DevTools.</span></span><br><span class="line">    win.webContents.openDevTools()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Emitted when the window is closed.</span></span><br><span class="line">    win.on(<span class="string">'closed'</span>, () =&gt; &#123;</span><br><span class="line">        <span class="comment">// Dereference the window object, usually you would store windows</span></span><br><span class="line">        <span class="comment">// in an array if your app supports multi windows, this is the time</span></span><br><span class="line">        <span class="comment">// when you should delete the corresponding element.</span></span><br><span class="line">        win = <span class="literal">null</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This method will be called when Electron has finished</span></span><br><span class="line"><span class="comment">// initialization and is ready to create browser windows.</span></span><br><span class="line"><span class="comment">// Some APIs can only be used after this event occurs.</span></span><br><span class="line">app.on(<span class="string">'ready'</span>, createWindow)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Quit when all windows are closed.</span></span><br><span class="line">app.on(<span class="string">'window-all-closed'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="comment">// On macOS it is common for applications and their menu bar</span></span><br><span class="line">    <span class="comment">// to stay active until the user quits explicitly with Cmd + Q</span></span><br><span class="line">    <span class="keyword">if</span> (process.platform !== <span class="string">'darwin'</span>) &#123;</span><br><span class="line">        app.quit()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.on(<span class="string">'activate'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="comment">// On macOS it's common to re-create a window in the app when the</span></span><br><span class="line">    <span class="comment">// dock icon is clicked and there are no other windows open.</span></span><br><span class="line">    <span class="keyword">if</span> (win === <span class="literal">null</span>) &#123;</span><br><span class="line">        createWindow()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- src/renderer/index.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    We are using node <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">document</span>.write(process.versions.node)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>,</span><br><span class="line">    Chrome <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">document</span>.write(process.versions.chrome)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>,</span><br><span class="line">    and Electron <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">document</span>.write(process.versions.electron)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>.</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨æ ¹ç›®å½•è¿è¡Œ<code>electron .</code>(æˆ–è€…æ˜¯<code>./node_modules/.bin/electron .</code>)å¯åŠ¨ç¨‹åº</p><p>ä¸ºäº†ä»¥åæ–¹ä¾¿å¯åŠ¨ç¨‹åº, å°†è¿™æ®µå‘½ä»¤æ·»åŠ åˆ°<code>package.json</code>ä¸­</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// package.json éƒ¨åˆ†å†…å®¹</span><br><span class="line">"main": "src/main/main.js",</span><br><span class="line">"scripts": &#123;</span><br><span class="line">"start": "./node_modules/.bin/electron ."</span><br><span class="line">&#125;,</span><br><span class="line">"devDependencies": &#123;</span><br><span class="line">"electron": "^1.7.5"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¼€å‘æ¸²æŸ“çº¿ç¨‹"><a href="#å¼€å‘æ¸²æŸ“çº¿ç¨‹" class="headerlink" title="å¼€å‘æ¸²æŸ“çº¿ç¨‹"></a>å¼€å‘æ¸²æŸ“çº¿ç¨‹</h2><p>æ¸²æŸ“çº¿ç¨‹çš„å¼€å‘è·Ÿæ™®é€šçš„å‰ç«¯å¼€å‘æ²¡æœ‰å¤šå¤§çš„åŒºåˆ«, ä¸ºäº†å¼€å‘çš„æ•ˆç‡, æˆ‘ä»¬é€šå¸¸ä¼šé€‰æ‹©ä¸€æ¬¾å‰ç«¯å¼€å‘æ¡†æ¶, è¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯<code>Angular</code>, å½“ç„¶ä¹Ÿå¯ä»¥é€‰æ‹©å…¶ä»–çš„æ¡†æ¶, åªéœ€è¦æŒ‰ç…§ä¸‹æ–‡ä¸­çš„è¦æ±‚ä¿®æ”¹æ‰“åŒ…è·¯å¾„.</p><h3 id="å¯¼å…¥Angular-å¯é€‰-ä½¿ç”¨å…¶ä»–æ¡†æ¶å¯ä»¥è·³è¿‡"><a href="#å¯¼å…¥Angular-å¯é€‰-ä½¿ç”¨å…¶ä»–æ¡†æ¶å¯ä»¥è·³è¿‡" class="headerlink" title="å¯¼å…¥Angular(å¯é€‰, ä½¿ç”¨å…¶ä»–æ¡†æ¶å¯ä»¥è·³è¿‡)"></a>å¯¼å…¥Angular(å¯é€‰, ä½¿ç”¨å…¶ä»–æ¡†æ¶å¯ä»¥è·³è¿‡)</h3><p>è¿™é‡Œæˆ‘ä½¿ç”¨<code>Angular-cli</code>å·¥å…·æ¥åˆå§‹åŒ–é¡¹ç›®</p><ol><li><p>å®‰è£…cliå·¥å…·</p><p> <code>npm install -g @angular/cli</code></p></li><li><p>åˆå§‹åŒ–ç›®å½•</p><p> <code>ng new electron-base -sd src/renderer -si -sg -st --routing true --styles scss</code> </p></li><li><p>ä¿®æ”¹<code>.angular-cli.json</code></p> <figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">"apps": [&#123;</span><br><span class="line">  "root": "src/renderer",// æºæ–‡ä»¶ç›®å½•</span><br><span class="line">  "outDir": "out/renderer", // è¾“å‡ºç›®å½•</span><br><span class="line">  "baseHref": "./", // è§£å†³æ‰“åŒ…åæ— æ³•åŠ è½½æ–‡ä»¶</span><br><span class="line">  ...</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure></li></ol><h3 id="å¦‚ä½•åœ¨å¼€å‘è¿‡ç¨‹ä¸­è¿›è¡Œä»£ç çƒ­æ›´æ–°"><a href="#å¦‚ä½•åœ¨å¼€å‘è¿‡ç¨‹ä¸­è¿›è¡Œä»£ç çƒ­æ›´æ–°" class="headerlink" title="å¦‚ä½•åœ¨å¼€å‘è¿‡ç¨‹ä¸­è¿›è¡Œä»£ç çƒ­æ›´æ–°"></a>å¦‚ä½•åœ¨å¼€å‘è¿‡ç¨‹ä¸­è¿›è¡Œä»£ç çƒ­æ›´æ–°</h3><p>å‰ç«¯å¼€å‘ä¸­, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>webpack</code>äº«å—åˆ°è‡ªåŠ¨åˆ·æ–°ã€çƒ­æ›´æ–°ç­‰æ–¹ä¾¿çš„åŠŸèƒ½ï¼Œ é‚£ä¹ˆåœ¨Electronçš„å¼€å‘è¿‡ç¨‹æˆ‘ä»¬å¦‚ä½•äº«å—çš„åˆ°è¿™äº›åŠŸèƒ½äº†ï¼Ÿè¿™é‡Œæˆ‘ä»¬åªéœ€è¦ç®€å•çš„ä¿®æ”¹ä¸‹<code>main.js</code>æ–‡ä»¶å³å¯</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isDev</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> process.env[<span class="string">'NODE_ENV'</span>] === <span class="string">'development'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createWindow</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    win = <span class="keyword">new</span> BrowserWindow(&#123; <span class="attr">width</span>: <span class="number">800</span>, <span class="attr">height</span>: <span class="number">600</span> &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isDev()) &#123;</span><br><span class="line">        <span class="comment">// è¿™é‡Œçš„urlæ¢æˆä½ æ‰€ä½¿ç”¨æ¡†æ¶å¼€å‘æ—¶çš„url</span></span><br><span class="line">        win.loadURL(<span class="string">'http://127.0.0.1:4200'</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        win.loadURL(url.format(&#123;</span><br><span class="line">            pathname: path.join(__dirname, <span class="string">'../renderer/index.html'</span>),</span><br><span class="line">            protocol: <span class="string">'file:'</span>,</span><br><span class="line">            slashes: <span class="literal">true</span></span><br><span class="line">        &#125;))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Open the DevTools.</span></span><br><span class="line">    win.webContents.openDevTools()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Emitted when the window is closed.</span></span><br><span class="line">    win.on(<span class="string">'closed'</span>, () =&gt; &#123;</span><br><span class="line">        <span class="comment">// Dereference the window object, usually you would store windows</span></span><br><span class="line">        <span class="comment">// in an array if your app supports multi windows, this is the time</span></span><br><span class="line">        <span class="comment">// when you should delete the corresponding element.</span></span><br><span class="line">        win = <span class="literal">null</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼€å‘æ—¶æˆ‘ä»¬è¿˜æ˜¯æŒ‰ç…§ä»¥å‰çš„æ–¹å¼å¯åŠ¨ä¸€ä¸ª<code>webpcak</code>æœåŠ¡å™¨è¿›è¡Œå¼€å‘, Electroné€šè¿‡<code>HTTP</code>åè®®æ‰“å¼€é¡µé¢, è¿™æ ·æˆ‘ä»¬ä¾æ—§å¯ä»¥äº«å—åˆ°ä»£ç çƒ­æ›´æ–°ç­‰åŠŸèƒ½.</p><p>é€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡<code>NODE_ENV</code>æ¥åŒºåˆ†å¼€å‘å’Œç”Ÿæˆç¯å¢ƒ, åœ¨<code>package.json</code>ä¸­æ·»åŠ ä¸¤ä¸ªå‘½ä»¤æ¥æ–¹ä¾¿å¼€å‘</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">  "ng": "ng", // angular alias</span><br><span class="line">  "start": "NODE_EBV=production ./node_modules/.bin/electron .", // æ·»åŠ ç¯å¢ƒå˜é‡</span><br><span class="line">  "dev:renderer": "ng serve" // å¯åŠ¨æ¸²æŸ“çº¿ç¨‹å¼€å‘æœåŠ¡å™¨</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h3 id="æ‰“åŒ…æ¸²æŸ“çº¿ç¨‹ä»£ç "><a href="#æ‰“åŒ…æ¸²æŸ“çº¿ç¨‹ä»£ç " class="headerlink" title="æ‰“åŒ…æ¸²æŸ“çº¿ç¨‹ä»£ç "></a>æ‰“åŒ…æ¸²æŸ“çº¿ç¨‹ä»£ç </h3><p>å¼€å‘å®Œæˆåæˆ‘ä»¬éœ€è¦å°†å‰ç«¯çš„ä»£ç è¿›è¡Œä»£ç æ‰“åŒ…, ä¸€ä¸ªå¥½çš„ä¹ æƒ¯æ˜¯å°†ä»£ç çš„æ‰“åŒ…ç›®å½•æ”¾ç½®åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸­, è¿™é‡Œæˆ‘å°†å‰ç«¯çš„æ‰“åŒ…ç›®å½•è®¾ç½®åœ¨<code>out/renderer</code>ä¸­</p><p>Angularé¡¹ç›®åªéœ€è¦ä¿®æ”¹<code>.angular-cli.json</code>ä¸­çš„<code>outDir</code>å­—æ®µ, å…¶ä»–çš„æ¡†æ¶å¯ä»¥è‡ªè¡Œä¿®æ”¹. </p><p>åœ¨<code>package.json</code>ä¸­æ·»åŠ æ‰“åŒ…å‘½ä»¤</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">  ....</span><br><span class="line">  "build:renderer": "ng buidl --prod" // æ‰“åŒ…æ¸²æŸ“çº¿ç¨‹ä»£ç </span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h2 id="å¼€å‘ä¸»çº¿ç¨‹"><a href="#å¼€å‘ä¸»çº¿ç¨‹" class="headerlink" title="å¼€å‘ä¸»çº¿ç¨‹"></a>å¼€å‘ä¸»çº¿ç¨‹</h2><p>ä¸»çº¿ç¨‹çš„å¼€å‘å¦‚<code>Node</code>ç¨‹åºçš„å¼€å‘æ²¡æœ‰å¤šå¤§çš„åŒºåˆ«, è¿™é‡Œå°±ä¸å¤šèµ˜è¿°.</p><p>è™½ç„¶<code>Node</code>å¯¹<code>ES6</code>çš„æ”¯æŒå·²ç»å¾ˆå®Œå–„äº†, ä½†æ›´æ–°çš„æ ‡å‡†çš„æ”¯æŒå°±ä¸æ€ä¹ˆå¥½, è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>Babel</code>ä¹‹ç±»çš„å·¥å…·è¿›è¡Œæ¥ä½¿ç”¨æœ€æ–°çš„è¯­æ³•.</p><p>è¿™é‡Œæˆ‘æ¨èä½¿ç”¨<code>Typescript</code>, ä¼˜ç‚¹ä¸»è¦æœ‰ä¸‰ä¸ª:</p><ol><li>é™æ€æ£€æŸ¥, æ¯•ç«Ÿæ˜¯ä¸»çº¿ç¨‹çš„ä»£ç , æœ‰ç‚¹é”™è¯¯å¯å°±æ˜¯ç¨‹åºç›´æ¥å´©æºƒçš„èŠ‚å¥</li><li>è‡ªåŠ¨æç¤º, è¿™ä¸ªä¸è§£é‡Š</li><li>ç¼–è¯‘æ–¹ä¾¿, æ¯”èµ·<code>Babel</code>çš„é…ç½®æ–‡ä»¶, <code>Typescript</code>çš„é…ç½®è¦ç®€å•çš„å¤š</li></ol><h3 id="ä½¿ç”¨Typescript-ä¸ä½¿ç”¨çš„å¯ä»¥è·³è¿‡"><a href="#ä½¿ç”¨Typescript-ä¸ä½¿ç”¨çš„å¯ä»¥è·³è¿‡" class="headerlink" title="ä½¿ç”¨Typescript (ä¸ä½¿ç”¨çš„å¯ä»¥è·³è¿‡)"></a>ä½¿ç”¨Typescript (ä¸ä½¿ç”¨çš„å¯ä»¥è·³è¿‡)</h3><ol><li><p>å®‰è£…<code>Typescript</code></p><p>è¿è¡Œ<code>npm install typescript -D</code></p></li><li><p>æ·»åŠ é…ç½®æ–‡ä»¶, åœ¨<code>src</code>ç›®å½•ä¸‹æ·»åŠ <code>tsconfig.main.json</code>æ–‡ä»¶</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"compilerOptions"</span>: &#123;</span><br><span class="line">        "outDir": "../out",  // è¾“å‡ºç›®å½•, åŒæ¸²æŸ“çº¿ç¨‹æ”¾åœ¨ä¸€èµ·</span><br><span class="line">        "sourceMap": true, // è°ƒè¯•æ—¶éœ€è¦</span><br><span class="line">        "moduleResolution": "node",</span><br><span class="line">        "emitDecoratorMetadata": true,</span><br><span class="line">        "experimentalDecorators": true,</span><br><span class="line">        "target": "es6",     // è¾“å‡ºä»£ç ç‰ˆæœ¬, ç”±äºåœ¨Nodeä¸­è¿è¡Œ, es6æ²¡é—®é¢˜</span><br><span class="line">        "module": "commonjs",// module å¤„ç†æ–¹å¼</span><br><span class="line">        "typeRoots": [// .d.ts ç›®å½•</span><br><span class="line">            <span class="string">"../node_modules/@types"</span></span><br><span class="line">        ],</span><br><span class="line">        "lib": [// å¯é€‰, æ·»åŠ æ–°çš„è¯­æ³•æ”¯æŒ</span><br><span class="line">            <span class="string">"es2017"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">   "exclude": [// æ’é™¤æ¸²æŸ“çº¿ç¨‹ç›®å½•</span><br><span class="line">        <span class="string">"renderer"</span></span><br><span class="line">   ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åœ¨<code>package.json</code>ä¸­æ·»åŠ å¼€å‘å’Œæ‰“åŒ…å‘½ä»¤</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">...</span><br><span class="line">  "dev:main": "tsc -p ./src/tsconfig.main.json -w", // å¼€å‘</span><br><span class="line">  "build:main": "tsc -p ./src/tsconfig.main.json"   // æ‰“åŒ…</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="ä¸»çº¿ç¨‹è°ƒè¯•-ä½¿ç”¨çš„ç¼–è¾‘å™¨æ˜¯vscode"><a href="#ä¸»çº¿ç¨‹è°ƒè¯•-ä½¿ç”¨çš„ç¼–è¾‘å™¨æ˜¯vscode" class="headerlink" title="ä¸»çº¿ç¨‹è°ƒè¯• (ä½¿ç”¨çš„ç¼–è¾‘å™¨æ˜¯vscode)"></a>ä¸»çº¿ç¨‹è°ƒè¯• (ä½¿ç”¨çš„ç¼–è¾‘å™¨æ˜¯vscode)</h3><ol><li><p>æ·»åŠ å¯åŠ¨é…ç½®æ–‡ä»¶, é¡¹ç›®æ ¹ç›®å½•æ–°å»º<code>.vscode</code>æ–‡ä»¶å¤¹,åœ¨å…¶ä¸­æ–°å»º<code>launch.json</code></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    // Use IntelliSense to learn about possible Node.js debug attributes.</span><br><span class="line">    // Hover to view descriptions of existing attributes.</span><br><span class="line">    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387</span><br><span class="line">    "version": "0.2.0",</span><br><span class="line">    "configurations": [&#123;</span><br><span class="line">        "type": "node",</span><br><span class="line">        "request": "launch",</span><br><span class="line">        "name": "Launch Program",</span><br><span class="line">        "cwd": "$&#123;workspaceRoot&#125;",</span><br><span class="line">        "runtimeExecutable": "$&#123;workspaceRoot&#125;/node_modules/.bin/electron",</span><br><span class="line">        "program": "$&#123;workspaceRoot&#125;/src/main/main.ts", // ä½ çš„ä¸»æ–‡ä»¶</span><br><span class="line">        "sourceMaps": true,</span><br><span class="line">        "outFiles": [</span><br><span class="line">            "$&#123;workspaceRoot&#125;/out/**/*.js"// ä½ çš„è¾“å‡ºæ–‡ä»¶ç›®å½•</span><br><span class="line">        ],</span><br><span class="line">        "env": &#123;</span><br><span class="line">            "NODE_ENV": "development"</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨ç»„åˆé”®<code>ctrl + f5</code>å¯åŠ¨ç¨‹åº</p></li><li><p>åœ¨æ–‡ä»¶ä¸­æ·»åŠ æ–­ç‚¹è¿›è¡Œè°ƒè¯•</p></li></ol><h3 id="ä¸»çº¿ç¨‹å¼€å¯è‡ªåŠ¨åˆ·æ–°-å¯é€‰"><a href="#ä¸»çº¿ç¨‹å¼€å¯è‡ªåŠ¨åˆ·æ–°-å¯é€‰" class="headerlink" title="ä¸»çº¿ç¨‹å¼€å¯è‡ªåŠ¨åˆ·æ–° (å¯é€‰)"></a>ä¸»çº¿ç¨‹å¼€å¯è‡ªåŠ¨åˆ·æ–° (å¯é€‰)</h3><p>æˆ‘ä»¬çš„æ¸²æŸ“çº¿ç¨‹å¯ä»¥åšåˆ°ä»£ç å˜æ›´åè‡ªåŠ¨åˆ·æ–°é¡µé¢, åœ¨ä¸»çº¿ç¨‹çš„å¼€å‘ä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href="https://github.com/remy/nodemon" target="_blank" rel="noopener">nodemon</a> æ¥å®ç°åŒæ ·çš„åŠŸèƒ½</p><ol><li><p>å®‰è£…<code>nodemon</code></p><p><code>npm install nodemon -D</code></p></li><li><p>ä¿®æ”¹å¯åŠ¨å‘½ä»¤</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">"start": "nodemon --watch src/main --watch src/shared --exec './node_modules/.bin/electron' ./out/main/main.js"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>ä»¥åå¼€å‘æ—¶åªéœ€è¦è¿è¡Œ<code>npm start</code>å°±å¯åšåˆ°ä¸»çº¿ç¨‹çš„è‡ªåŠ¨åˆ·æ–°</p><h3 id="æ‰“åŒ…ä¸»çº¿ç¨‹"><a href="#æ‰“åŒ…ä¸»çº¿ç¨‹" class="headerlink" title="æ‰“åŒ…ä¸»çº¿ç¨‹"></a>æ‰“åŒ…ä¸»çº¿ç¨‹</h3><p>ä¸»çº¿ç¨‹çš„å¼€å‘è¿‡ç¨‹æˆ‘ä»¬å¯èƒ½ä¼šä½¿ç”¨å…¶ä»–çš„æ„å»ºå·¥å…·, è¿™é‡Œæˆ‘ä»¬åŒæ¸²æŸ“çº¿ç¨‹ä¸€æ ·, å°†ä¸»çº¿ç¨‹çš„æ‰“åŒ…æ–‡ä»¶æ”¾åœ¨<code>out</code>ç›®å½•ä¸­, è‡³æ­¤æ‰“åŒ…ç›®å½•çš„ç»“æ„åº”å½“å¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">out</span><br><span class="line">â”œâ”€â”€ main - ä¸»çº¿ç¨‹æ‰“åŒ…æ–‡ä»¶ä½ç½®</span><br><span class="line">â”‚   â””â”€â”€ main.js - å…¥å£æ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ renderer - æ¸²æŸ“çº¿ç¨‹æ‰“åŒ…ä½ç½®</span><br><span class="line">â”‚   â”œâ”€â”€ .... </span><br><span class="line">â”‚   â””â”€â”€ index.html - å…¥å£é¡µé¢</span><br><span class="line">â””â”€â”€ shared - å…¬ç”¨æ–‡ä»¶</span><br><span class="line">    â””â”€â”€ utils.js</span><br></pre></td></tr></table></figure><h2 id="æ‰“åŒ…å’Œå‘å¸ƒ"><a href="#æ‰“åŒ…å’Œå‘å¸ƒ" class="headerlink" title="æ‰“åŒ…å’Œå‘å¸ƒ"></a>æ‰“åŒ…å’Œå‘å¸ƒ</h2><p><a href="https://github.com/electron-userland/electron-builder" target="_blank" rel="noopener">electron-builder</a> å¯ä»¥å°†æˆ‘ä»¬çš„ç¨‹åºæ‰“åŒ…æˆå¯æ‰§è¡Œæ–‡ä»¶, å®ƒçš„é…ç½®ä¿¡æ¯å‘åœ¨<code>package.json</code>ä¸­</p><p>è¿™é‡Œé…ç½®çš„æ˜¯<code>Mac</code>çš„æ‰“åŒ…ä¿¡æ¯, å…·ä½“çš„å¯ä»¥è‡ªè¡ŒæŸ¥é˜…æ–‡æ¡£</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  "main": "out/main/main.js", // å…¥å£æ–‡ä»¶</span><br><span class="line">  "scripts": &#123;</span><br><span class="line">...</span><br><span class="line">    "pack": "electron-builder -m --dir", // ç®€å•æ‰“åŒ…è½¯ä»¶, ç”¨äºæµ‹è¯•</span><br><span class="line">    "dist": "electron-builder -m",     // æ­£å¼æ‰“åŒ…è½¯ä»¶</span><br><span class="line">    "build": "npm run build:renderer &amp;&amp; npm run build:main &amp;&amp; npm run dist" // æ‰“åŒ…è½¯ä»¶</span><br><span class="line">  &#125;,</span><br><span class="line">  "build": &#123;</span><br><span class="line">    "appId": "com.lleohao.sample", // è‡ªè¡Œä¿®æ”¹ </span><br><span class="line">    "mac": &#123;</span><br><span class="line">      "category": "public.app-category.productivity" // è‡ªè¡Œä¿®æ”¹</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œ<code>npm build</code>å³å¯æ‰“åŒ…è½¯ä»¶</p><h2 id="å¼€å‘æµç¨‹"><a href="#å¼€å‘æµç¨‹" class="headerlink" title="å¼€å‘æµç¨‹"></a>å¼€å‘æµç¨‹</h2><ol><li>è¿è¡Œ<code>npm run dev:renderer</code>å¯åŠ¨æ¸²æŸ“çº¿ç¨‹å¼€å‘</li><li>è¿è¡Œ<code>npm run dev:main</code>å¯åŠ¨ä¸»çº¿ç¨‹å¼€å‘</li><li>è¿è¡Œ<code>npm start</code>æ‰“å¼€<code>Electron</code>ç¨‹åº</li><li>è¿è¡Œ<code>npm build</code>æ‰“åŒ…ç¨‹åº</li></ol><p>ç¤ºä¾‹é¡¹ç›®åœ°å€ <a href="https://github.com/lleohao/electron-base" target="_blank" rel="noopener">https://github.com/lleohao/electron-base</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;è¿™ä¸ªé¡¹ç›®ç»“æ„æ˜¯æˆ‘åœ¨ç¼–å†™  &lt;a href=&quot;https://github.com/lleohao/qiniu-upload&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;åŸºäºElectron å’Œ Angular çš„ä¸ƒç‰›æ–‡ä»¶ä¸Šä¼ App&lt;/a&gt;  æ€»ç»“å‡ºæ¥çš„&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•ä»é›¶å¼€å§‹æ­å»ºé«˜æ•ˆçš„Electronå¼€å‘ç¯å¢ƒ, ä¸»è¦å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é€šè¿‡åˆç†çš„ç›®å½•åˆ’åˆ†æ¥ç»„ç»‡ä»£ç &lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;npm script&lt;/code&gt;ç®€åŒ–å¼€å‘&lt;/li&gt;
&lt;li&gt;å¦‚ä½•åœ¨æ¸²æŸ“è¿›ç¨‹å¼€å‘æ—¶ä½¿ç”¨çƒ­æ›´æ–°&lt;/li&gt;
&lt;li&gt;å¦‚ä½•åœ¨ä¸»è¿›ç¨‹å¼€å‘æ—¶ä½¿ç”¨è‡ªåŠ¨é‡å¯&lt;/li&gt;
&lt;li&gt;å¦‚ä½•åœ¨ä¸»è¿›ç¨‹å¼€å‘æ—¶ä½¿ç”¨&lt;code&gt;Typescript&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å¦‚ä½•æ‰“åŒ…å’Œå‘å¸ƒè½¯ä»¶&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç¤ºä¾‹é¡¹ç›®åœ°å€ &lt;a href=&quot;https://github.com/lleohao/electron-base&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/lleohao/electron-base&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;&lt;h2 id=&quot;ç›®å½•ç»“æ„åˆ’åˆ†&quot;&gt;&lt;a href=&quot;#ç›®å½•ç»“æ„åˆ’åˆ†&quot; class=&quot;headerlink&quot; title=&quot;ç›®å½•ç»“æ„åˆ’åˆ†&quot;&gt;&lt;/a&gt;ç›®å½•ç»“æ„åˆ’åˆ†&lt;/h2&gt;&lt;h3 id=&quot;åˆå§‹åŒ–ç›®å½•&quot;&gt;&lt;a href=&quot;#åˆå§‹åŒ–ç›®å½•&quot; class=&quot;headerlink&quot; title=&quot;åˆå§‹åŒ–ç›®å½•&quot;&gt;&lt;/a&gt;åˆå§‹åŒ–ç›®å½•&lt;/h3&gt;&lt;p&gt;é¦–å…ˆæŒ‰ç…§å¸¸è§„çš„æ–¹æ³•æ–°å»ºä¸€ä¸ªé¡¹ç›®æ–‡ä»¶å¤¹(è¿™é‡Œæˆ‘çš„ç¤ºä¾‹æ–‡ä»¶å¤¹å«åš&lt;code&gt;electron-base&lt;/code&gt;ï¼Œ ç„¶åä½¿ç”¨&lt;code&gt;npm init&lt;/code&gt;åˆå§‹åŒ–ç›®å½•ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="æŒ‡å—" scheme="https://lleohao.github.io/tags/%E6%8C%87%E5%8D%97/"/>
    
      <category term="Electron" scheme="https://lleohao.github.io/tags/Electron/"/>
    
      <category term="Angular" scheme="https://lleohao.github.io/tags/Angular/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€ç¯‡æ–‡ç« è§£å†³è·¨åŸŸ</title>
    <link href="https://lleohao.github.io/2017/08/12/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F/"/>
    <id>https://lleohao.github.io/2017/08/12/ä¸€ç¯‡æ–‡ç« è§£å†³è·¨åŸŸ/</id>
    <published>2017-08-12T07:13:35.000Z</published>
    <updated>2020-11-24T06:07:16.912Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>åŸæ–‡åœ°å€ <a href="https://www.html5rocks.com/en/tutorials/cors/" target="_blank" rel="noopener">Using CORS</a></p><p>éƒ¨åˆ†å†…å®¹æˆ‘ç²¾ç®€äº†éƒ¨åˆ†å†…å®¹, å¦‚æœæƒ³çœ‹å…¨éƒ¨å¯ä»¥å»ä¸Šé¢çš„åŸæ–‡åœ°å€æŸ¥çœ‹</p><p>åŒæ—¶ä¹Ÿé™„ä¸Š<a href="https://mubu.com/doc/1Mdo8geHR8" target="_blank" rel="noopener">è„‘å›¾</a></p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><a href="http://www.w3.org/TR/cors/" target="_blank" rel="noopener">Cross-Origin Resource Sharing</a>(CORS) æ˜¯W3Cä¸ºæµè§ˆå™¨åˆ¶å®šçš„å¯ä»¥è·¨åŸŸé€šä¿¡çš„è§„èŒƒ. é€šè¿‡ä½¿ç”¨ XMLHttpRequest å¯¹è±¡, CORSå¯ä»¥è®©å¼€å‘è€…æ–¹ä¾¿çš„è¿›è¡Œè·¨åŸŸé€šä¿¡, å°±åƒåœ¨ä½¿ç”¨åŒåŸŸé€šä¿¡ä¸€æ ·.</p><p>CORSçš„ä½¿ç”¨ååˆ†ç®€å•. æƒ³è±¡ä¸€ä¸‹æœ‰ä¸€ä¸ªç½‘ç«™ a.com æƒ³è¦è·å–å¦ä¸€ä¸ªç½‘ç«™ b.com çš„æ•°æ®. ä½†ç”±äºæµè§ˆå™¨çš„<a href="https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy" target="_blank" rel="noopener">åŒæºç­–ç•¥</a>, è¿™æ ·çš„è¯·æ±‚å°†ä¼šè¢«ç¦æ­¢. è¿™æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨CORS, é€šè¿‡æ·»åŠ ä¸€äº›ç‰¹æ®Šçš„è¯·æ±‚\å“åº”å¤´, å¯ä»¥è®© a.com è®¿é—® b.com çš„æ•°æ®.</p><a id="more"></a><p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥çœ‹å‡º, CORSçš„æ”¯æŒéœ€è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åŒæ—¶æ”¯æŒæ‰è¡Œ. å¹¸è¿çš„æ˜¯, å¦‚æœä½ æ˜¯ä¸€åå®¢æˆ·ç«¯çš„å¼€å‘äººå‘˜(å¦‚å‰ç«¯å·¥ç¨‹å¸ˆ), ç»å¤§å¤šæ•°çš„æŠ€æœ¯ç»†èŠ‚éƒ½ä¼šè¢«éšè—æ‰.</p><p>è¿™ç¯‡æ–‡ç« å°†è®²è¿°å®¢æˆ·ç«¯å¦‚ä½•å‘é€ä¸€ä¸ªè·¨åŸŸè¯·æ±‚, è€ŒæœåŠ¡å™¨åˆå°†å¦‚ä½•å»å¤„ç†å’Œæ”¯æŒè·¨åŸŸè¯·æ±‚.</p><h2 id="å‘é€ä¸€ä¸ªè·¨åŸŸè¯·æ±‚"><a href="#å‘é€ä¸€ä¸ªè·¨åŸŸè¯·æ±‚" class="headerlink" title="å‘é€ä¸€ä¸ªè·¨åŸŸè¯·æ±‚"></a>å‘é€ä¸€ä¸ªè·¨åŸŸè¯·æ±‚</h2><p>æ—¶è‡³ä»Šæ—¥, å‘é€ä¸€ä¸ªXMLHttprequestè¯·æ±‚å·²ç»æ˜¯ä¸€ä¸ªç®€å•çš„äº‹æƒ…, è¿™é‡Œæˆ‘ä¸åœ¨è¿‡å¤šèµ˜è¿°.</p><p>æ ¹æ®æµè§ˆå™¨çš„åŒæºç­–ç•¥, å½“è¯·æ±‚çš„åœ°å€ä¸æ¥æºåœ°å€çš„åè®®\åŸŸå\ç«¯å£ä¸­çš„ä»»ä¸€å€¼ä¸ç›¸åŒæ—¶, å‡è§†ä¸ºæ˜¯ä¸€ä¸ªè·¨åŸŸçš„è¯·æ±‚.</p><h3 id="XMLHttprequest-çš„-withCredentials-å±æ€§"><a href="#XMLHttprequest-çš„-withCredentials-å±æ€§" class="headerlink" title="XMLHttprequest çš„ withCredentials å±æ€§"></a>XMLHttprequest çš„ withCredentials å±æ€§</h3><p>è·¨åŸŸè¯·æ±‚é€šå¸¸ä¸ä¼šæºå¸¦cookiesä¿¡æ¯. ä¸ºäº†èƒ½è®©è·¨åŸŸè¯·æ±‚å¸¦ä¸Šcookies, ä½ éœ€è¦å°†åšå¦‚ä¸‹è®¾ç½®:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.withCredentials = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†èƒ½è®©è¿™ä¸ªå±æ€§æ­£å¸¸å·¥ä½œ, ä½ è¿˜éœ€è¦åœ¨æœåŠ¡å™¨ç«¯åœ¨å“åº”æ˜¯å¸¦ä¸Š<code>Access-Control-Allow-Credentials</code> , åŒæ—¶å®ƒçš„å€¼å¿…é¡»ä¸ºtrue. æ›´å¤šçš„å†…å®¹å¯ä»¥çœ‹<a href="#å¤„ç†ä¸€ä¸ªéç®€å•è¯·æ±‚">æœåŠ¡å™¨è®¾ç½®</a>çš„é‚£ä¸€éƒ¨åˆ†.</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Access-Control-Allow-Credentials</span>: true</span><br></pre></td></tr></table></figure><p>è®¾ç½®withCredentialsä¸ºtrueå, åœ¨äºæœåŠ¡å™¨è¿›è¡Œé€šä¿¡æ—¶ä¼šæºå¸¦è¿™ä¸ªåŸŸåä¸‹çš„æ‰€æœ‰cookies, åŒæ—¶æœåŠ¡å™¨ä¹Ÿå¯ä»¥åœ¨å®ƒçš„äºåŸŸåä¸‹è®¾ç½®cookies. <strong>ä½†å€¼å¾—æ³¨æ„çš„æ˜¯, è¿™äº›cookiesä»ç„¶éµå®ˆæµè§ˆå™¨çš„åŒæºç­–ç•¥, ä½ æ— æ³•é€šè¿‡javascriptè®¿é—®è¿™ä¸ªåŸŸåä¸‹çš„cookies, å®ƒåªè¢«è¿™ä¸ªåŸŸåçš„æœåŠ¡å™¨æ§åˆ¶.</strong></p><h2 id="ä¸ºæœåŠ¡å™¨å¢åŠ è·¨åŸŸè¯·æ±‚çš„æ”¯æŒ"><a href="#ä¸ºæœåŠ¡å™¨å¢åŠ è·¨åŸŸè¯·æ±‚çš„æ”¯æŒ" class="headerlink" title="ä¸ºæœåŠ¡å™¨å¢åŠ è·¨åŸŸè¯·æ±‚çš„æ”¯æŒ"></a>ä¸ºæœåŠ¡å™¨å¢åŠ è·¨åŸŸè¯·æ±‚çš„æ”¯æŒ</h2><p>å¤§éƒ¨åˆ†è·¨åŸŸè¯·æ±‚çš„é‡è¦æ“ä½œå®åœ¨æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´è¿›è¡Œçš„. æµè§ˆå™¨åœ¨è·¨åŸŸè¯·æ±‚æœŸé—´ä¼šä»£è¡¨å®¢æˆ·ç«¯åœ¨è¯·æ±‚ä¸Šå¢åŠ è¡Œçš„è¯·æ±‚å¤´, æœ‰çš„æ—¶å€™è¿˜ä¼šå¢åŠ æ–°çš„è¯·æ±‚. è¿™äº›æ“ä½œå¯¹äºå¼€å‘è€…æ¥è¯´æ˜¯é€æ˜, ä½†æ˜¯è¿™äº›è¯·æ±‚ä»ç„¶å¯ä»¥è¢«æŠ“åŒ…å·¥å…·æ•è·.</p><p><img src="./cors_flow.png" alt="è·¨åŸŸè¯·æ±‚"></p><p>æµè§ˆå™¨çš„å¼€å‘è€…æ¥å®ç°æµè§ˆå™¨ç«¯çš„è·¨åŸŸè¯·æ±‚ç»†èŠ‚, è¿™èŠ‚å†…å®¹æ¥ä»‹ç»å¦‚ä½•é…ç½®æœåŠ¡å™¨æ¥æ”¯æŒè·¨åŸŸè¯·æ±‚.</p><h3 id="è·¨åŸŸè¯·æ±‚çš„åˆ†ç±»"><a href="#è·¨åŸŸè¯·æ±‚çš„åˆ†ç±»" class="headerlink" title="è·¨åŸŸè¯·æ±‚çš„åˆ†ç±»"></a>è·¨åŸŸè¯·æ±‚çš„åˆ†ç±»</h3><p>é€šå¸¸å°†è·¨è¶Šè¯·æ±‚åˆ†ä¸ºâ€ç®€å•è¯·æ±‚â€å’Œâ€éç®€å•è¯·æ±‚â€ä¸¤ç±».</p><p>ç®€å•è¯·æ±‚éµå¾ªä»¥ä¸‹çš„è§„åˆ™</p><p><img src="./simple_http_request.png" alt="ç®€å•è¯·æ±‚"></p><p>é¦–å…ˆå®ƒçš„è¯·æ±‚æ–¹å¼åªèƒ½æ˜¯GET, POST, PUT</p><p>åŒæ—¶çš„å®ƒçš„è¯·æ±‚å¤´éƒ¨åªèƒ½åŒ…å«ä¸Šé¢çš„é‚£å‡ ä¸ªç±»å‹, å€¼çš„æ³¨æ„çš„æ˜¯<code>Content-Type</code>åªèƒ½æ˜¯ç½—åˆ—å‡ºçš„ä¸‰ç§(æ­£å¥½æ˜¯formçš„entryTypeçš„ä¸‰ä¸ªå€¼).</p><p>å¯¹äºç®€å•è¯·æ±‚, æµè§ˆå™¨å¯ä»¥è‡ªè¡Œè§£å†³å…¶ä¸­çš„è·¨åŸŸé—®é¢˜. ä¾‹å¦‚æˆ‘ä»¬ç†ŸçŸ¥çš„ä¸€ä¸ªè·¨åŸŸé€šä¿¡çš„è§£å†³æ–¹å¼<code>JSON-P</code>å°±æ˜¯åˆ©ç”¨GETå‘é€ä¸€ä¸ªç®€å•è¯·æ±‚æ¥è§„é¿è·¨åŸŸçš„é—®é¢˜.HTMLä¸­çš„è¡¨å•æäº¤ä¹Ÿä¸éœ€è¦å¤„ç†è·¨åŸŸé—®é¢˜.</p><p>ä»»ä½•ä¸ç¬¦åˆä¸Šè¿°æ¡ä»¶çš„è¯·æ±‚éƒ½ç®—ä½œéç®€å•è¯·æ±‚, æµè§ˆå™¨åœ¨å¤„ç†éç®€å•çš„è·¨åŸŸè¯·æ±‚æ—¶ä¼šä¸æœåŠ¡å™¨è¿›è¡Œé¢å¤–çš„é€šä¿¡(ç§°ä¹‹ä¸ºé¢„æ£€è¯·æ±‚), å°†åœ¨ä¸‹é¢ä»‹ç».</p><h3 id="å¤„ç†ç®€å•è¯·æ±‚"><a href="#å¤„ç†ç®€å•è¯·æ±‚" class="headerlink" title="å¤„ç†ç®€å•è¯·æ±‚"></a>å¤„ç†ç®€å•è¯·æ±‚</h3><blockquote><p>é€šè¿‡è¿™ä¸ª<a href="https://github.com/lleohao/cors-demo" target="_blank" rel="noopener">cors-demo</a>æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„æŸ¥çœ‹æµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´çš„åŒä¿¡.</p></blockquote><p>å½“æµè§ˆå™¨å‘é€ä¸€ä¸ªç®€å•è¯·æ±‚æ—¶, æˆ‘ä»¬æ‰“å¼€æµè§ˆå™¨çš„Networké¢æ¿å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¦‚ä¸‹çš„è¯·æ±‚(åˆ é™¤éƒ¨åˆ†å†…å®¹)</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/get</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: localhost:5051</span><br><span class="line"><span class="attribute">Origin</span>: http://localhost:8080</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 ....</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate, br</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,en;q=0.8,zh;q=0.6,ja;q=0.4,zh-TW;q=0.2</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯, <strong>æ‰€æœ‰çš„è·¨åŸŸè¯·æ±‚(æ— è®ºç®€å•æˆ–è€…éç®€å•)æ€»ä¼šåŒ…å«ä¸€ä¸ª<code>Origin</code>çš„è¯·æ±‚å¤´éƒ¨, è¿™ä¸ªå±æ€§çš„å€¼ç”±æµè§ˆå™¨æ·»åŠ , è€Œä¸”ä¸å—ç”¨æˆ·æ§åˆ¶. å®ƒçš„å€¼ç”±åè®®(å¦‚: http), åŸŸå(å¦‚: a.om)å’Œç«¯å£(åªæœ‰å®ƒä¸æ˜¯é»˜è®¤å€¼æ—¶æ‰åŒ…å«, å¦‚80ç«¯å£)ç»„æˆ, è¯´æ˜è¯·æ±‚çš„æ¥æº.</strong></p><p>åŒ…å«<code>Origin</code>çš„è¯·æ±‚ä¸ä¸€å®šæ˜¯è·¨åŸŸè¯·æ±‚, ä½†æ˜¯è·¨åŸŸè¯·æ±‚ä¸€å®šåŒ…å«<code>Origin</code>. ä¸€äº›åŒæºçš„è¯·æ±‚åŒæ ·ä¹Ÿä¼šåŒ…å«<code>Origin</code>è¯·æ±‚å¤´.ä¾‹å¦‚, Firefoxæµè§ˆå™¨ä¸ä¼šåœ¨åŒæºçš„è¯·æ±‚ä¸­æ·»åŠ <code>Origin</code>, ä½†æ˜¯Chromeå’ŒSafariä¼šåœ¨åŒæºçš„POST/PUT/DELETEè¯·æ±‚ä¸­æ·»åŠ <code>Origin</code>è¯·æ±‚å¤´(ä½†æ˜¯åŒæºçš„GETä¸ä¼šæ·»åŠ ).</p><p>æµè§ˆå™¨ä¼šå¿½ç•¥æ‰åŒæºè¯·æ±‚ä¸­çš„çš„CORSå“åº”ä¸­çš„è®¾ç½®.</p><p>ç„¶åæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªæœ‰æ•ˆçš„è·¨åŸŸè¯·æ±‚å“åº”</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Access-Control-Allow-Origin</span>: http://localhost:8080</span><br><span class="line"><span class="attribute">Access-Control-Allow-Credentials</span>: true</span><br><span class="line"><span class="attribute">Access-Control-Expose-Headers</span>: FooBar</span><br><span class="line"><span class="attribute">Content-Type</span>: text/html; charset=utf-8</span><br></pre></td></tr></table></figure><p>æ‰€æœ‰ä¸è·¨åŸŸè¯·æ±‚ç›¸å…³çš„HTTPå¤´éƒ¨éƒ½ä»¥<code>Access-Control-</code>å¼€å§‹, ä¸‹é¢æ˜¯å®ƒä»¬çš„è¯¦ç»†ä¿¡æ¯</p><ol><li><p>Access-Control-Allow-Origin (å¿…é€‰)</p><p>æ‰€æœ‰æœ‰æ•ˆçš„è·¨åŸŸå“åº”éƒ½å¿…é¡»åŒ…å«è¿™ä¸ªè¯·æ±‚å¤´, æ²¡æœ‰çš„è¯ä¼šå¯¼è‡´è·¨åŸŸè¯·æ±‚å¤±è´¥. å®ƒçš„å€¼å¯ä»¥æ˜¯è¯·æ±‚ä¸­çš„<code>Origin</code>çš„å€¼, ä¹Ÿå¯ä»¥è®¾ç½®ä¸º<code>*</code>æ¥è¡¨ç¤ºå¯ä»¥å“åº”æ‰€æœ‰æ¥æºçš„è¯·æ±‚.</p></li><li><p>Access-Control-Allow-Credentials (å¯é€‰)</p><p>é»˜è®¤æƒ…å†µä¸‹è·¨åŸŸè¯·æ±‚ä¸ä¼šæºå¸¦cookiesä¿¡æ¯. å¦‚æœéœ€è¦è¯·æ±‚æºå¸¦cookiesä¿¡æ¯, åˆ™éœ€è¦å°†è¿™ä¸ªå€¼è®¾ç½®ä¸º<code>true</code>, å¦‚æœä¸éœ€è¦å°±ä¸è¦è®¾ç½®è¿™ä¸ªå€¼, <strong>è€Œä¸æ˜¯å°†å®ƒè®¾ç½®ä¸º<code>false</code></strong>.</p><p>è¿™ä¸ªè¯·æ±‚å¤´éœ€è¦ä¸ [withCredentials](#XMLHttprequest çš„ withCredentials å±æ€§) é…åˆä½¿ç”¨. åªæœ‰ä¸¤ä¸ªå€¼éƒ½è®¾ç½®ä¸º<code>true</code>çš„æ—¶å€™æ‰èƒ½å¤Ÿåœ¨è¯·æ±‚ä¸­æºå¸¦cookiesä¿¡æ¯. å½“<code>withCredentials</code>è®¾ç½®ä¸º<code>true</code>, è€Œå“åº”ä¸­ä¸åŒ…å«<code>Access-Control-Allow-Credentials</code>æ—¶, è¯·æ±‚ä¼šå‘ç”Ÿé”™è¯¯.</p></li><li><p>Access-Control-Expose-Headers (å¯é€‰)</p><p>XMLHttpRequest2å¯¹è±¡ä¸Šçš„<code>getResponseHeader()</code>æ–¹æ³•å¯ä»¥è®©ä½ è·å–åˆ°å“åº”ä¸­å¤´éƒ¨ä¿¡æ¯, ä½†åœ¨è·¨åŸŸè¯·æ±‚ä¸­,ä½ åªèƒ½è·å–åˆ°ä»¥ä¸‹ä¿¡æ¯</p><ul><li>Cache-Control</li><li>Content-Language</li><li>Content-Type</li><li>Expires</li><li>Last-Modified</li><li>Pragma</li></ul><p>å¦‚æœä½ å¸Œæœ›å®¢æˆ·ç«¯èƒ½è¿‡è·å–å…¶ä»–çš„å¤´éƒ¨ä¿¡æ¯, å¯ä»¥è®¾ç½®è¿™ä¸ªå€¼.</p></li></ol><h3 id="å¤„ç†ä¸€ä¸ªéç®€å•è¯·æ±‚"><a href="#å¤„ç†ä¸€ä¸ªéç®€å•è¯·æ±‚" class="headerlink" title="å¤„ç†ä¸€ä¸ªéç®€å•è¯·æ±‚"></a>å¤„ç†ä¸€ä¸ªéç®€å•è¯·æ±‚</h3><p>å¯¹ä¸å¼€å‘è€…æ¥è¯´, å‘é€ä¸€ä¸ªè·¨åŸŸçš„éç®€å•è¯·æ±‚è·Ÿå‘é€ä¸€ä¸ªåŒåŸŸè¯·æ±‚æ²¡ä»€ä¹ˆåŒºåˆ«.ä½†äº‹å®ä¸Šæµè§ˆå™¨ä¼šå‘é€ä¸¤ä¸ªè¯·æ±‚, ç¬¬ä¸€ä¸ªè¯·æ±‚(æˆä¸ºé¢„æ£€è¯·æ±‚)ä¼šåƒæœåŠ¡å™¨ç¡®å®šæ˜¯å¦æ¥å—è¿™ä¸ªè·¨åŸŸè¯·æ±‚, ç¬¬äºŒä¸ªæ‰æ˜¯çœŸæ­£çš„å‘å‡ºè¯·æ±‚. æµè§ˆå™¨è‡ªåŠ¨çš„å¤„ç†è¿™ä¸¤ä¸ªè¯·æ±‚, åŒæ—¶é¢„æ£€è¯·æ±‚ä¹Ÿæ˜¯å¯ä»¥è¢«ç¼“å­˜çš„, è€Œä¸ç”¨æ¯æ¬¡è¯·æ±‚éƒ½éœ€è¦å‘é€é¢„æ£€è¯·æ±‚.</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªé¢„æ£€è¯·æ±‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">OPTIONS</span> <span class="string">/cors/post</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: localhost:5051</span><br><span class="line"><span class="attribute">Access-Control-Request-Method</span>: POST</span><br><span class="line"><span class="attribute">Access-Control-Request-Headers</span>: content-type</span><br><span class="line"><span class="attribute">Origin</span>: http://localhost:8080</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 ...</span><br><span class="line"><span class="attribute">DNT</span>: 1</span><br><span class="line"><span class="attribute">Referer</span>: http://localhost:8080/</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate, br</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,en;q=0.8,zh;q=0.6,ja;q=0.4,zh-TW;q=0.2</span><br></pre></td></tr></table></figure><p>å¦‚åŒç®€å•è·¨åŸŸè¯·æ±‚ä¸€æ ·, åœ¨é¢„æ£€è¯·æ±‚ä¸­ä¹ŸåŒ…å«äº†<code>Origin</code>è¯·æ±‚å¤´, åŒæ—¶è¿™ä¸ªè¯·æ±‚çš„æ–¹å¼<code>OPTIONS</code>(æ‰€ä»¥ä½ å¿…é¡»ç¡®å®šä½ çš„æœåŠ¡å™¨èƒ½å¤Ÿæ­£å¸¸çš„å¤„ç†è¿™ä¸­è¯·æ±‚). å®ƒåŒæ—¶ä¹ŸåŒ…å«äº†å…¶ä»–çš„è¯·æ±‚å¤´.</p><ol><li><p>Access-Control-Request-Method</p><p>è¿™ä¸ªè¯·æ±‚å¤´çš„å€¼å°±æ˜¯æ­£å¼è¯·æ±‚çš„è¯·æ±‚æ–¹å¼, ä¸Šé¢çš„é‚£ä¸ªä¾‹å­å°±æ˜¯POST</p></li><li><p>Access-Control-Request-Headers</p><p>å®ƒçš„å€¼æ˜¯ä¸€ä¸ªç”±é€—å·åˆ†éš”çš„æ­£å¼è¯·æ±‚ä¸­è¯·æ±‚å¤´çš„åˆ—è¡¨.</p></li></ol><p>é¢„æ£€è¯·æ±‚æ˜¯åœ¨å®é™…çš„è¯·æ±‚å‘å‡ºå‰å…ˆå‘æœåŠ¡å™¨ç¡®è®¤æ˜¯å¦èƒ½å¤Ÿå¤„ç†è¿™ä¸ªè¯·æ±‚. æœåŠ¡å™¨åº”è¯¥æ£€æŸ¥ä¸Šè¾¹ä¸¤ä¸ªè¯·æ±‚å¤´çš„å€¼, æ¥åˆ¤æ–­è¿™ä¸ªè¯·æ±‚æ˜¯å¦æœ‰æ•ˆ.</p><p>å¦‚æœæœåŠ¡å™¨ç¡®è®¤è¿™ä¸ªè¯·æ±‚æœ‰æ•ˆ, é‚£ä¹ˆå®ƒä¼šåšå‡ºå¦‚ä¸‹çš„å“åº”</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Access-Control-Allow-Origin</span>: http://localhost:8080</span><br><span class="line"><span class="attribute">Access-Control-Allow-Headers</span>: Content-Type</span><br><span class="line"><span class="attribute">Access-Control-Allow-Methods</span>: GET, POST, PUT, DELETE</span><br><span class="line"><span class="attribute">Content-Type</span>: text/html</span><br><span class="line"><span class="attribute">Date</span>: Sat, 12 Aug 2017 13:46:08 GMT</span><br><span class="line"><span class="attribute">Connection</span>: keep-alive</span><br><span class="line"><span class="attribute">Transfer-Encoding</span>: chunked</span><br></pre></td></tr></table></figure><ol><li><p>Access-Control-Allow-Origin (å¿…é€‰)</p><p>å¦‚åŒç®€å•è·¨åŸŸè¯·æ±‚ä¸€æ ·, é¢„æ£€è¯·æ±‚çš„å“åº”ä¹Ÿå¿…é¡»åŒ…å«è¿™ä¸ªå€¼</p></li><li><p>Access-Control-Allow-Methods (å¿…é€‰)</p><p>ç”±é€—å·åˆ†éš”çš„HTTPè¯·æ±‚æ–¹å¼, åœ¨å…¶ä¸­çš„å€¼è¡¨ç¤ºæœåŠ¡èƒ½å¤Ÿæ¥å—è¿™ä¸­è¯·æ±‚æ–¹å¼çš„è·¨åŸŸè¯·æ±‚.</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯è™½ç„¶é¢„æ£€è¯·æ±‚åªæ˜¯é’ˆå¯¹å•ä¸ªè¯·æ±‚æ–¹å¼è¿›è¡Œæ£€æµ‹, ä½†æ˜¯ä½ ä»å¯ä»¥è¿”å›ä¸€ä¸ªä½ æ‰€æ”¯æŒçš„è¯·æ±‚æ–¹å¼åˆ—è¡¨.è¿™æ ·åšçš„å¥½å¤„æ˜¯æ–¹ä¾¿å¯¹é¢„æ£€è¯·æ±‚è¿›è¡Œç¼“å­˜.</p></li><li><p>Access-Control-Allow-Headers (å½“é¢„æ£€è¯·æ±‚ä¸­åŒ…å«Access-Control-Request-Headersæ—¶æ˜¯å¿…é¡»çš„)</p><p>ç”±é€—å·åˆ†éš”çš„æ”¯æŒçš„è¯·æ±‚å¤´éƒ¨åˆ—è¡¨, ä¸<code>Access-Control-Allow-Methods</code>ç±»ä¼¼, è™½ç„¶é¢„æ£€è¯·æ±‚ä¸­åªæœ‰å¾ˆå°‘çš„ä¸€éƒ¨åˆ†è¯·æ±‚å¤´, ä½†æ˜¯ä½ ä»ç„¶å¯ä»¥è¿”å›æ‰€æœ‰ä½ æ”¯æŒçš„åˆ—è¡¨, åŸå› ä¹Ÿæ˜¯ä¸ºäº†ç¼“å­˜.</p></li><li><p>Access-Control-Allow-Credentials (å¯é€‰)</p><p>åŒç®€å•è¯·æ±‚</p></li><li><p>Access-Control-Max-Age (å¯é€‰)</p><p>åœ¨æ¯ä¸ªè¯·æ±‚å‰é¢éƒ½å‘é€ä¸€ä¸ªé¢„æ£€è¯·æ±‚æ˜¯å¾ˆæµªè´¹èµ„æºçš„, è¿™ä¸ªå€¼å…è®¸ä½ è®¾ç½®é¢„æ£€è¯·æ±‚çš„ç¼“å­˜æ—¶é—´, å•ä½æ˜¯ç§’.</p></li></ol><p>ä¸€æ—¦é¢„æ£€è¯·æ±‚é€šè¿‡æœåŠ¡å™¨çš„æ£€æŸ¥, é‚£ä¹ˆæµè§ˆå™¨ä¼šéšåå‘é€å®é™…çš„è¯·æ±‚. å®é™…è¯·æ±‚çš„å¤„ç†ä¸ç®€å•è¯·æ±‚ä¸€æ ·.</p><p>å¦‚æœæœåŠ¡å™¨æƒ³è¦æ‹’ç»ä¸€ä¸ªè·¨åŸŸè¯·æ±‚, é‚£ä¹ˆä»–å¯ä»¥ç›´æ¥å›å¤ä¸€ä¸ªç®€å•çš„å“åº”(å¦‚ HTTP 200), ä½†åœ¨å“åº”å¤´ä¸­ä¸è¦åŒ…å«ä»»ä½•ä¸CORSç›¸å…³çš„å“åº”å¤´è®¾ç½®. æœåŠ¡å™¨ä¹Ÿå¯èƒ½ä¼šå› ä¸ºé¢„æ£€è¯·æ±‚ä¸åˆæ³•è€Œæ‹’ç»è¿™ä¸ªè¯·æ±‚. å¦‚æœé¢„æ£€è¯·æ±‚ä¸­ä¸åŒ…å«æ­£ç¡®çš„CORSå¤´éƒ¨è®¾ç½®, å®ƒå°±ä¸ä¼šå‘é€å®é™…çš„è¯·æ±‚.</p><p>å½“è·¨åŸŸè¯·æ±‚å‘ç”Ÿé”™æ—¶, æµè§ˆå™¨ä¼šè°ƒç”¨<code>onerror</code>äº‹ä»¶, åŒæ—¶ä¼šåœ¨æ§åˆ¶å°æ‰“å°ç›¸å…³çš„é”™è¯¯ä¿¡æ¯.</p><p><img src="./cors_error.png" alt="cors request error"></p><p>æœ€åé™„ä¸Šä¸€ä¸ªæœåŠ¡å™¨ç«¯å¤„ç†è·¨åŸŸè¯·æ±‚çš„æµç¨‹å›¾</p><p><img src="./cors_server_flowchart.png" alt="æœåŠ¡å™¨å¤„ç†è·¨åŸŸè¯·æ±‚æµç¨‹å›¾"></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;åŸæ–‡åœ°å€ &lt;a href=&quot;https://www.html5rocks.com/en/tutorials/cors/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Using CORS&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;éƒ¨åˆ†å†…å®¹æˆ‘ç²¾ç®€äº†éƒ¨åˆ†å†…å®¹, å¦‚æœæƒ³çœ‹å…¨éƒ¨å¯ä»¥å»ä¸Šé¢çš„åŸæ–‡åœ°å€æŸ¥çœ‹&lt;/p&gt;
&lt;p&gt;åŒæ—¶ä¹Ÿé™„ä¸Š&lt;a href=&quot;https://mubu.com/doc/1Mdo8geHR8&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è„‘å›¾&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;http://www.w3.org/TR/cors/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Cross-Origin Resource Sharing&lt;/a&gt;(CORS) æ˜¯W3Cä¸ºæµè§ˆå™¨åˆ¶å®šçš„å¯ä»¥è·¨åŸŸé€šä¿¡çš„è§„èŒƒ. é€šè¿‡ä½¿ç”¨ XMLHttpRequest å¯¹è±¡, CORSå¯ä»¥è®©å¼€å‘è€…æ–¹ä¾¿çš„è¿›è¡Œè·¨åŸŸé€šä¿¡, å°±åƒåœ¨ä½¿ç”¨åŒåŸŸé€šä¿¡ä¸€æ ·.&lt;/p&gt;&lt;p&gt;CORSçš„ä½¿ç”¨ååˆ†ç®€å•. æƒ³è±¡ä¸€ä¸‹æœ‰ä¸€ä¸ªç½‘ç«™ a.com æƒ³è¦è·å–å¦ä¸€ä¸ªç½‘ç«™ b.com çš„æ•°æ®. ä½†ç”±äºæµè§ˆå™¨çš„&lt;a href=&quot;https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;åŒæºç­–ç•¥&lt;/a&gt;, è¿™æ ·çš„è¯·æ±‚å°†ä¼šè¢«ç¦æ­¢. è¿™æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨CORS, é€šè¿‡æ·»åŠ ä¸€äº›ç‰¹æ®Šçš„è¯·æ±‚\å“åº”å¤´, å¯ä»¥è®© a.com è®¿é—® b.com çš„æ•°æ®.&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="å‰ç«¯" scheme="https://lleohao.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="åç«¯" scheme="https://lleohao.github.io/tags/%E5%90%8E%E7%AB%AF/"/>
    
      <category term="è·¨åŸŸ" scheme="https://lleohao.github.io/tags/%E8%B7%A8%E5%9F%9F/"/>
    
      <category term="CORS" scheme="https://lleohao.github.io/tags/CORS/"/>
    
  </entry>
  
  <entry>
    <title>è§£å†³jsé”®ç›˜äº‹ä»¶åœ¨å¤„ç†å°é”®ç›˜æ—¶çš„é—®é¢˜</title>
    <link href="https://lleohao.github.io/2017/01/12/%E8%A7%A3%E5%86%B3js%E9%94%AE%E7%9B%98%E4%BA%8B%E4%BB%B6%E5%9C%A8%E5%A4%84%E7%90%86%E5%B0%8F%E9%94%AE%E7%9B%98%E6%97%B6%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <id>https://lleohao.github.io/2017/01/12/è§£å†³jsé”®ç›˜äº‹ä»¶åœ¨å¤„ç†å°é”®ç›˜æ—¶çš„é—®é¢˜/</id>
    <published>2017-01-12T03:56:15.000Z</published>
    <updated>2020-11-24T06:07:16.916Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•é—®é¢˜ï¼Œåœ¨æ§åˆ¶å°è¾“å…¥ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æµ‹è¯•å¹³å° win10 chrome 55.0.2883.87</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'keydown'</span>, (e) =&gt; &#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">String</span>.fromCharCode(e.which))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨é¡µé¢ä¸ŠæŒ‰å°é”®ç›˜ä¸Šé¢çš„<code>1</code>é”®ï¼Œä½ è§‰å¾—ä¼šæ‰“å°å‡ºä»€ä¹ˆï¼Ÿ</p><blockquote><p>ç»“æœä¸º â€˜aâ€™ï¼Œwhy ?</p></blockquote><h2 id="é—®é¢˜åŸå› "><a href="#é—®é¢˜åŸå› " class="headerlink" title="é—®é¢˜åŸå› "></a>é—®é¢˜åŸå› </h2><p>æˆ‘ä»¬å…ˆçœ‹çœ‹MDNä¸­æ˜¯æ€ä¹ˆè§£é‡Š <code>KeyboardEvent</code>äº‹ä»¶ä¸­çš„è¿”å›å€¼</p><blockquote><p><code>keyCode</code>: This is usually the decimal ASCII.</p><p><code>which</code>:     this is usually the same as <code>keyCode</code>.</p><p>è¯¦ç»†ä¿¡æ¯å¯ä»¥çœ‹è¿™ä¸ª <a href="https://developer.mozilla.org/en-US/docs/Web/Events/keydown" target="_blank" rel="noopener">keydown</a></p></blockquote><a id="more"></a><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ‹¿åˆ°çš„è¿”å›å€¼å¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯é”®ç›˜æŒ‰é”®å¯¹åº”çš„<code>ASCII</code>ç ï¼Œå…·ä½“çš„<a href="http://wenku.baidu.com/view/39cbd36f1eb91a37f1115c88.html?from=search" target="_blank" rel="noopener">å¯¹ç…§è¡¨</a></p><p>ç„¶åå†çœ‹ä¸‹<code>String.fromCharCode()</code>æ¥å—çš„å‚æ•°æ˜¯ä»€ä¹ˆ</p><blockquote><p>The static <strong>String.fromCharCode()</strong> method returns a string created by using the specified sequence of <em>Unicode</em> values.</p></blockquote><p><code>String.fromCharCode()</code>æ¥å—çš„æ˜¯ä¸€ä¸ª<code>Unicode</code>ç¼–ç ï¼Œæ­£æ˜¯ç”±äºè¿™ä¸ªåŸå› æ‰å¯¼è‡´æˆ‘ä»¬è§£æå‡ºæ¥çš„æ•°æ®ä¸æ­£ç¡®ã€‚</p><p>å…³äº<code>Unicode</code>ç¼–ç ä¸<code>ASCII</code>ç¼–ç çš„ç›¸å…³çŸ¥è¯†å¯ä»¥çœ‹çœ‹<a href="http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a></p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><ol><li><p>ä½¿ç”¨<code>KeyboardEvent</code>äº‹ä»¶ä¸­çš„<code>key</code>å€¼ï¼Œè¿™ç§æ–¹å¼æœ€ç›´æ¥ï¼Œä½†æ˜¯ä¸æ”¯æŒ<code>Safari</code>ï¼Œå¦‚æœä¸éœ€è¦å…¼å®¹è‹¹æœçš„è®¾å¤‡è¿™æ˜¯æœ€å¥½çš„æ–¹å¼ã€‚</p><p><img src="charCode.png" alt></p></li><li><p>å¯ä»¥é€‰æ‹©ç›‘å¬<code>keypress</code>äº‹ä»¶ï¼Œè¿™ä¸ªäº‹ä»¶å¯¹è±¡æœ‰ä¸ªç‹¬æœ‰çš„å±æ€§å€¼<code>charCode</code>ï¼Œè¿”å›çš„æ˜¯<code>Unicode</code>ç¼–ç ã€‚è¿™æ ·çš„è¯ç”¨<code>String.fromCharCode()</code>å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p><p><img src="key.png" alt></p></li><li><p>ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„åº“ <a href="https://github.com/timoxley/keycode" target="_blank" rel="noopener">keycode</a></p></li></ol><h2 id="æ›´å¤šå†…å®¹"><a href="#æ›´å¤šå†…å®¹" class="headerlink" title="æ›´å¤šå†…å®¹"></a>æ›´å¤šå†…å®¹</h2><p>å‡ ä¸ªå°tips</p><ol><li><code>keypress</code>ã€<code>input</code>äº‹ä»¶ä¸ä¼šå“åº”è¾…åŠ©æŒ‰é”®ï¼Œå¦‚ï¼š<code>ctrl</code> <code>alt</code> <code>shift</code> ç­‰ï¼ŒæŸäº›æƒ…å†µä¸‹ä¼šå¾ˆæ–¹ä¾¿ã€‚</li><li><code>keypress</code>ã€<code>input</code>äº‹ä»¶ä¸å“åº”ä¸­æ–‡è¾“å…¥æ³•</li><li>ä¸­æ–‡è¾“å…¥æ³•å¯¹åº”æƒ…å†µä¸‹<code>keydown</code>çš„<code>which</code>å€¼ä¸º<code>299</code>ï¼Œ<code>keyup</code>å¯¹åº”çš„å€¼æ˜¯æ­£ç¡®çš„</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;é—®é¢˜æè¿°&quot;&gt;&lt;a href=&quot;#é—®é¢˜æè¿°&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜æè¿°&quot;&gt;&lt;/a&gt;é—®é¢˜æè¿°&lt;/h2&gt;&lt;p&gt;å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•é—®é¢˜ï¼Œåœ¨æ§åˆ¶å°è¾“å…¥ä¸‹é¢çš„ä»£ç ï¼š&lt;/p&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// æµ‹è¯•å¹³å° win10 chrome 55.0.2883.87&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.addEventListener(&lt;span class=&quot;string&quot;&gt;&#39;keydown&#39;&lt;/span&gt;, (e) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;built_in&quot;&gt;String&lt;/span&gt;.fromCharCode(e.which))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ç„¶ååœ¨é¡µé¢ä¸ŠæŒ‰å°é”®ç›˜ä¸Šé¢çš„&lt;code&gt;1&lt;/code&gt;é”®ï¼Œä½ è§‰å¾—ä¼šæ‰“å°å‡ºä»€ä¹ˆï¼Ÿ&lt;/p&gt;&lt;blockquote&gt;
&lt;p&gt;ç»“æœä¸º â€˜aâ€™ï¼Œwhy ?&lt;/p&gt;
&lt;/blockquote&gt;&lt;h2 id=&quot;é—®é¢˜åŸå› &quot;&gt;&lt;a href=&quot;#é—®é¢˜åŸå› &quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜åŸå› &quot;&gt;&lt;/a&gt;é—®é¢˜åŸå› &lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬å…ˆçœ‹çœ‹MDNä¸­æ˜¯æ€ä¹ˆè§£é‡Š &lt;code&gt;KeyboardEvent&lt;/code&gt;äº‹ä»¶ä¸­çš„è¿”å›å€¼&lt;/p&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;keyCode&lt;/code&gt;: This is usually the decimal ASCII.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;which&lt;/code&gt;:     this is usually the same as &lt;code&gt;keyCode&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;è¯¦ç»†ä¿¡æ¯å¯ä»¥çœ‹è¿™ä¸ª &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/Events/keydown&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;keydown&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
    
      <category term="å‰ç«¯" scheme="https://lleohao.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="JavaScript" scheme="https://lleohao.github.io/tags/JavaScript/"/>
    
  </entry>
  
</feed>
